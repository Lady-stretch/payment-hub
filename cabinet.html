<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LS Achievement Portal | 2026 Evolution</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;300;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --accent: #b085ff;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.15);
            --glow: rgba(176, 133, 255, 0.4);
            --bg: #050508;
        }

        body, html {
            margin: 0; padding: 0; min-height: 100vh;
            background: var(--bg); font-family: 'Montserrat', sans-serif;
            color: #fff; overflow-x: hidden; -webkit-tap-highlight-color: transparent;
        }

        /* –§–û–ù: –¢–í–û–ò –ó–í–ï–ó–î–´ + –ì–õ–£–ë–û–ö–û–ï –°–ò–Ø–ù–ò–ï */
        .universe {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -3;
            background: radial-gradient(circle at 50% 0%, #1e1340 0%, #050508 100%);
        }
        .aurora-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;
            background: radial-gradient(circle at 20% 30%, rgba(122, 90, 248, 0.12) 0%, transparent 50%),
                        radial-gradient(circle at 80% 70%, rgba(36, 240, 255, 0.08) 0%, transparent 50%);
            filter: blur(80px); animation: drift 20s infinite alternate;
        }
        @keyframes drift { from { transform: scale(1); } to { transform: scale(1.15); } }
        #starfield { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }

        header {
            position: fixed; top: 0; left: 0; width: 100%; height: 85px;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 25px; box-sizing: border-box; z-index: 1000;
            background: rgba(0,0,0,0.4); backdrop-filter: blur(30px); border-bottom: 1px solid var(--border);
        }
        .logo-wrap {
            width: 48px; height: 48px; border-radius: 50%; border: 1.5px solid var(--accent);
            overflow: hidden; box-shadow: 0 0 15px var(--glow); flex-shrink: 0;
        }
        .logo-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .h-title { flex: 1; text-align: center; font-weight: 100; letter-spacing: 3px; font-size: 11px; text-transform: uppercase; color: #fff; }

        /* –¢–í–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† (Desktop + Mobile Adaptation) */
        .container {
            max-width: 1200px; margin: 0 auto; padding: 110px 20px 50px;
            display: grid; grid-template-columns: 1fr 380px; gap: 30px;
        }

        /* –ñ–µ—Å—Ç–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ã */
        @media (max-width: 980px) {
            .container { grid-template-columns: 1fr; padding-top: 100px; }
            .h-title { font-size: 9px; letter-spacing: 1.5px; }
            .main-stat { font-size: 48px !important; }
        }

        .glass-card {
            background: var(--glass); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid var(--border); border-radius: 35px; padding: 30px;
            box-shadow: 0 20px 45px rgba(0,0,0,0.4); transition: 0.3s;
        }

        .grid-dirs { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 25px; }
        @media (max-width: 600px) { .grid-dirs { grid-template-columns: 1fr 1fr; } }

        .btn-dir {
            background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 22px;
            padding: 22px 10px; text-align: center; font-size: 11px; cursor: pointer; transition: 0.4s;
        }
        .btn-dir.active { background: #fff; color: #000; font-weight: 600; transform: scale(1.05); }

        .tag { font-size: 9px; letter-spacing: 3px; color: var(--accent); font-weight: 600; text-transform: uppercase; margin-bottom: 15px; display: block; }
        .main-stat { font-size: 56px; font-weight: 100; margin: 15px 0; letter-spacing: -2px; }
        .main-stat span { font-size: 18px; color: #444; }

        .bio-content { font-size: 14px; line-height: 1.7; font-weight: 300; color: rgba(255,255,255,0.8); min-height: 100px; }
        .bio-content b { color: var(--accent); font-weight: 600; }

        .input-panel { margin-top: 30px; padding-top: 25px; border-top: 1px solid var(--border); display: none; }
        .input-panel.visible { display: block; animation: slideIn 0.5s ease; }

        .f-input {
            width: 100%; background: transparent; border: none; border-bottom: 1.5px solid var(--accent);
            color: #fff; font-size: 32px; padding: 12px 0; outline: none; text-align: center;
        }
        .save-btn {
            width: 100%; background: #fff; color: #000; border: none; padding: 22px;
            border-radius: 25px; font-weight: 600; text-transform: uppercase; margin-top: 25px; cursor: pointer;
        }

        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(20px);
            z-index: 2000; display: none; align-items: center; justify-content: center;
        }
        .modal-card {
            background: var(--glass); border: 1px solid #fff; border-radius: 40px;
            padding: 45px; max-width: 450px; text-align: center; margin: 20px;
        }

        #chartCanvas { height: 260px !important; }
        .stat-line { display: flex; justify-content: space-between; border-bottom: 1px solid rgba(255,255,255,0.05); padding: 8px 0; font-size: 11px; }
    </style>
</head>
<body>

    <div class="universe"></div>
    <div class="aurora-layer"></div>
    <canvas id="starfield"></canvas>

    <header>
        <div class="logo-wrap"><img src="lady_logo.png" alt="LS"></div>
        <div class="h-title">Lady Stretch Portal 2026</div>
        <div class="menu-status" style="font-size:10px; color:var(--accent)">ID: 9824</div>
    </header>

    <div class="container">
        <div class="col-left">
            <div class="glass-card" style="margin-bottom: 25px;">
                <span class="tag">–î–∏–Ω–∞–º–∏–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</span>
                <canvas id="chartCanvas"></canvas>
            </div>

            <div class="grid-dirs">
                <div class="btn-dir" onclick="openBranch(this, 'abs')">–Ø–≥–æ–¥–∏—Ü—ã + –ü—Ä–µ—Å—Å</div>
                <div class="btn-dir" onclick="openBranch(this, 'spine')">–ó–¥–æ—Ä–æ–≤–∞—è —Å–ø–∏–Ω–∞</div>
                <div class="btn-dir" onclick="openBranch(this, 'stretch')">–®–ø–∞–≥–∞—Ç</div>
                <div class="btn-dir" onclick="openBranch(this, 'sky')">Sky Stretching</div>
                <div class="btn-dir" onclick="openBranch(this, 'tabata')">–¢–∞–±–∞—Ç–∞</div>
                <div class="btn-dir" onclick="openBranch(this, 'sculpt')">Body Sculpt</div>
            </div>
        </div>

        <div class="col-right">
            <div class="glass-card" style="margin-bottom: 25px; border-color: var(--accent);">
                <span class="tag">–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∏–Ω—Å–∞–π—Ç</span>
                <div class="bio-content" id="bio-info">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞...</div>
            </div>

            <div class="glass-card">
                <span class="tag">–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</span>
                <div class="main-stat" id="total-stat">0 <span>–∑–∞–Ω—è—Ç–∏–π</span></div>
                <div id="monthly-breakdown" style="margin-bottom: 20px;"></div>

                <div class="input-panel" id="input-block">
                    <span id="input-hint" style="font-size: 11px; display: block; margin-bottom: 10px; color: #888;"></span>
                    <input type="number" class="f-input" id="val-entry" placeholder="0" pattern="\d*">
                    <button class="save-btn" onclick="saveSession()">–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="milestone-modal" onclick="this.style.display='none'">
        <div class="modal-card">
            <span class="tag">–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω</span>
            <h1 id="ms-title" style="font-weight: 100; font-size: 42px;">8</h1>
            <p id="ms-desc" style="font-weight: 300; line-height: 1.6;"></p>
            <div id="ms-hook" style="margin-top:20px; color:var(--accent); font-style: italic;"></div>
        </div>
    </div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    let db = JSON.parse(localStorage.getItem('ls_final_v1')) || {
        isFirst: true,
        yearly: [0,0,0,0,0,0,0,0,0,0,0,0], 
        dirs: { abs: 0, spine: 0, stretch: 0, sky: 0, tabata: 0, sculpt: 0 },
        awards: { abs: 0, spine: 0, stretch: 0, sky: 0, tabata: 0, sculpt: 0 } // –•—Ä–∞–Ω–∏–º –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ –ø–æ—Ä–æ–≥–∏
    };

    let activeDir = '';
    const nowMonth = new Date().getMonth();

    const hooks = [
        "–¢–≤–æ—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ ‚Äî —ç—Ç–æ –ø—Ä–∏–º–µ—Ä –¥–ª—è –ø–æ–¥—Ä–∞–∂–∞–Ω–∏—è! ‚ú®",
        "–¢—ã —Å—Ç–∞–Ω–æ–≤–∏—à—å—Å—è –≥—Ä–∞—Ü–∏–æ–∑–Ω–µ–µ —Å –∫–∞–∂–¥—ã–º –¥–Ω–µ–º. üå∏",
        "–ü–æ—Ç—Ä—è—Å–∞—é—â–∏–π —Ç–µ–º–ø, —Ç—ã –Ω–∞—Å—Ç–æ—è—â–∞—è –º–æ–ª–æ–¥–µ—Ü! üî•",
        "–¢–≤–æ–µ —Ç–µ–ª–æ –≥–æ–≤–æ—Ä–∏—Ç —Ç–µ–±–µ '—Å–ø–∞—Å–∏–±–æ'! üßò‚Äç‚ôÄÔ∏è",
        "–≠—Ç–æ –ø–æ–±–µ–¥–∞ –Ω–∞–¥ —Å–æ–±–æ–π. –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å! üöÄ"
    ];

    const scienceMap = {
        abs: {
            info: "<b>–í–∏—Å—Ü–µ—Ä–∞–ª—å–Ω—ã–π –¥–µ—Ç–æ–∫—Å:</b> –ì–ª—É–±–æ–∫–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –º—ã—à—Ü –ø—Ä–µ—Å—Å–∞ —Å–æ–∑–¥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç –º–∞—Å—Å–∞–∂–∞ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –æ—Ä–≥–∞–Ω–æ–≤, —É–ª—É—á—à–∞—è –∫—Ä–æ–≤–æ—Ç–æ–∫ –≤ –≤–æ—Ä–æ—Ç–Ω–æ–π –≤–µ–Ω–µ –ø–µ—á–µ–Ω–∏.",
            ms8: "<b>8 –∑–∞–Ω—è—Ç–∏–π:</b> –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª—Å—è –º—ã—à–µ—á–Ω—ã–π –∫–æ—Ä—Å–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∞–ª –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ä–≥–∞–Ω—ã –≤ –∞–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ–º –ø–æ–ª–æ–∂–µ–Ω–∏–∏.",
            ms16: "<b>16 –∑–∞–Ω—è—Ç–∏–π:</b> –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –º—ã—à–µ—á–Ω—ã—Ö –≤–æ–ª–æ–∫–æ–Ω –≤—ã—Ä–æ—Å–ª–∞. –ú–µ—Ç–∞–±–æ–ª–∏–∑–º –≤ –ø–æ–∫–æ–µ —É—Å–∫–æ—Ä–∏–ª—Å—è –Ω–∞ 7%."
        },
        spine: {
            info: "<b>–ì–∏–¥—Ä–∞—Ç–∞—Ü–∏—è –¥–∏—Å–∫–æ–≤:</b> –î–≤–∏–∂–µ–Ω–∏—è –≤ –æ—Å–µ–≤–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–∂–ø–æ–∑–≤–æ–Ω–æ—á–Ω—ã–µ —Ö—Ä—è—â–∏ –≤–ø–∏—Ç—ã–≤–∞—Ç—å –ø–∏—Ç–∞—Ç–µ–ª—å–Ω—É—é –∂–∏–¥–∫–æ—Å—Ç—å, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∏—Ö '–≤—ã—Å—ã—Ö–∞–Ω–∏–µ'.",
            ms8: "<b>8 –∑–∞–Ω—è—Ç–∏–π:</b> –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –æ–±—ä–µ–º —Å–∏–Ω–æ–≤–∏–∞–ª—å–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏. –£—à–ª–∏ —É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–∫–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –∑–∞–∂–∏–º—ã.",
            ms16: "<b>16 –∑–∞–Ω—è—Ç–∏–π:</b> –î–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –†–æ—Å—Ç —É–≤–µ–ª–∏—á–∏–ª—Å—è –Ω–∞ 0.5-1—Å–º –∑–∞ —Å—á–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤—ã—Å–æ—Ç—ã –¥–∏—Å–∫–æ–≤."
        },
        stretch: {
            info: "<b>–ö–∞–ø–∏–ª–ª—è—Ä–Ω–∞—è —Å–µ—Ç—å:</b> –†–∞—Å—Ç—è–∂–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–¥–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–∞–ø–∏–ª–ª—è—Ä—ã. –ú—ã—à—Ü—ã –Ω–∞—á–∏–Ω–∞—é—Ç –ø–æ–ª—É—á–∞—Ç—å –≤ 4 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤.",
            ms8: "<b>8 –∑–∞–Ω—è—Ç–∏–π:</b> –§–∞—Å—Ü–∏–∏ —Å—Ç–∞–ª–∏ —ç–ª–∞—Å—Ç–∏—á–Ω—ã–º–∏. –£—à–µ–ª —ç—Ñ—Ñ–µ–∫—Ç '–¥–µ—Ä–µ–≤—è–Ω–Ω–æ–≥–æ —Ç–µ–ª–∞'. –õ–∏–º—Ñ–∞ –¥–≤–∏–∂–µ—Ç—Å—è —Å–≤–æ–±–æ–¥–Ω–æ.",
            ms16: "<b>16 –∑–∞–Ω—è—Ç–∏–π:</b> –¢–∫–∞–Ω–∏ —Å—Ç–∞–ª–∏ —à–µ–ª–∫–æ–≤–∏—Å—Ç—ã–º–∏. –¢–≤–æ–π –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–æ–Ω —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è."
        },
        sky: {
            info: "<b>–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–∑–≥—Ä—É–∑–∫–∞:</b> –†–∞–±–æ—Ç–∞ –≤ –≥–∞–º–∞–∫–µ —Å–Ω–∏–º–∞–µ—Ç –æ—Å–µ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Å –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞, –ø–æ–∑–≤–æ–ª—è—è —Å—É—Å—Ç–∞–≤–∞–º —Ä–∞—Å–∫—Ä—ã—Ç—å—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º—è–≥–∫–æ.",
            ms8: "<b>8 –∑–∞–Ω—è—Ç–∏–π:</b> –£–ª—É—á—à–∏–ª–∞—Å—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∏ —Ä–∞–±–æ—Ç–∞ –≤–µ—Å—Ç–∏–±—É–ª—è—Ä–Ω–æ–≥–æ –∞–ø–ø–∞—Ä–∞—Ç–∞.",
            ms16: "<b>16 –∑–∞–Ω—è—Ç–∏–π:</b> –õ–∏–º—Ñ–æ–¥—Ä–µ–Ω–∞–∂–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —Å—Ç–∞–ª –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º. –õ–∏—Ü–æ —Å—Ç–∞–ª–æ —á–∏—â–µ, —É—à–ª–∏ –æ—Ç–µ–∫–∏."
        },
        tabata: {
            info: "<b>–ú–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏–∞–ª—å–Ω—ã–π –≤–∑—Ä—ã–≤:</b> –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –∫–ª–µ—Ç–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏.",
            ms8: "<b>8 –∑–∞–Ω—è—Ç–∏–π:</b> –û–±—ä–µ–º –ª–µ–≥–∫–∏—Ö —É–≤–µ–ª–∏—á–∏–ª—Å—è. –°–µ—Ä–¥—Ü–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–Ω–µ–µ.",
            ms16: "<b>16 –∑–∞–Ω—è—Ç–∏–π:</b> –¢–µ–ª–æ –ø–µ—Ä–µ—à–ª–æ –≤ —Ä–µ–∂–∏–º –∂–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏—è 'Afterburn'."
        },
        sculpt: {
            info: "<b>–ú–∏–∫—Ä–æ—Ä–µ–ª—å–µ—Ñ:</b> –†–∞–±–æ—Ç–∞ —Å –º–∞–ª—ã–º –≤–µ—Å–æ–º —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–ª–æ—Ç–Ω—ã–µ, '—Å—É—Ö–∏–µ' –º—ã—à—Ü—ã –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ –æ–±—ä–µ–º–∞.",
            ms8: "<b>8 –∑–∞–Ω—è—Ç–∏–π:</b> –ú—ã—à–µ—á–Ω—ã–π —Ç–æ–Ω—É—Å —Å—Ç–∞–ª –∑–∞–º–µ—Ç–µ–Ω –≤–∏–∑—É–∞–ª—å–Ω–æ.",
            ms16: "<b>16 –∑–∞–Ω—è—Ç–∏–π:</b> –ö–∞—á–µ—Å—Ç–≤–æ —Ç–µ–ª–∞ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å. –°–Ω–∏–∑–∏–ª—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–¥–∫–æ–∂–Ω–æ–≥–æ –∂–∏—Ä–∞."
        }
    };

    const ctx = document.getElementById('chartCanvas').getContext('2d');
    const chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['–Ø–Ω–≤','–§–µ–≤','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–ò—é–Ω','–ò—é–ª','–ê–≤–≥','–°–µ–Ω','–û–∫—Ç','–ù–æ—è','–î–µ–∫'],
            datasets: [{
                data: db.yearly,
                backgroundColor: 'rgba(176, 133, 255, 0.4)',
                borderRadius: 8
            }]
        },
        options: {
            responsive: true, maintainAspectRatio: false,
            scales: { y: { display: false }, x: { grid: {display: false}, ticks: {color: '#555'} } },
            plugins: { legend: { display: false } }
        }
    });

    function openBranch(btn, type) {
        document.querySelectorAll('.btn-dir').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        activeDir = type;
        document.getElementById('bio-info').innerHTML = scienceMap[type]?.info;
        document.getElementById('input-block').classList.add('visible');
        document.getElementById('input-hint').innerText = db.isFirst ? "–í–≤–µ–¥–∏ –æ–±—â—É—é –±–∞–∑—É —Å –Ω–∞—á–∞–ª–∞ –≥–æ–¥–∞" : `–¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: ${db.dirs[type]}`;
        document.getElementById('val-entry').focus();
    }

    function saveSession() {
        const val = parseInt(document.getElementById('val-entry').value) || 0;
        
        db.dirs[activeDir] += val;
        db.yearly[nowMonth] += val;

        // –õ–æ–≥–∏–∫–∞ 8+ –∏ 16+ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤)
        const totalInDir = db.dirs[activeDir];
        if (totalInDir >= 8 && db.awards[activeDir] < 8) {
            db.awards[activeDir] = 8;
            triggerMilestone(activeDir, 8);
        } else if (totalInDir >= 16 && db.awards[activeDir] < 16) {
            db.awards[activeDir] = 16;
            triggerMilestone(activeDir, 16);
        }

        db.isFirst = false;
        document.getElementById('val-entry').value = '';
        updateAll();
        tg.HapticFeedback.notificationOccurred('success');
    }

    function triggerMilestone(type, count) {
        const msData = scienceMap[type];
        document.getElementById('ms-title').innerText = count + ' –ó–ê–ù–Ø–¢–ò–ô';
        document.getElementById('ms-desc').innerHTML = count === 8 ? msData.ms8 : msData.ms16;
        document.getElementById('ms-hook').innerText = hooks[Math.floor(Math.random() * hooks.length)];
        document.getElementById('milestone-modal').style.display = 'flex';
    }

    function updateAll() {
        const total = Object.values(db.dirs).reduce((a, b) => a + b, 0);
        document.getElementById('total-stat').innerHTML = `${total} <span>–∑–∞–Ω—è—Ç–∏–π</span>`;
        
        const nMap = {abs:'–ü—Ä–µ—Å—Å', spine:'–°–ø–∏–Ω–∞', stretch:'–®–ø–∞–≥–∞—Ç', sky:'Sky', tabata:'–¢–∞–±–∞—Ç–∞', sculpt:'Sculpt'};
        let html = '';
        for(let key in db.dirs) {
            if(db.dirs[key] > 0) html += `<div class="stat-line"><span>${nMap[key]}</span> <b>${db.dirs[key]} –∑–∞–Ω.</b></div>`;
        }
        document.getElementById('monthly-breakdown').innerHTML = html;
        chart.data.datasets[0].data = db.yearly;
        chart.update();
        localStorage.setItem('ls_final_v1', JSON.stringify(db));
    }

    // –ó–í–ï–ó–î–´
    const sCanvas = document.getElementById('starfield');
    const sCtx = sCanvas.getContext('2d');
    let stars = [];
    function initStars() {
        sCanvas.width = window.innerWidth; sCanvas.height = window.innerHeight;
        stars = Array.from({length: 150}, () => ({
            x: Math.random()*sCanvas.width, y: Math.random()*sCanvas.height,
            size: Math.random()*1.5, t: Math.random()*Math.PI*2, speed: 0.02
        }));
    }
    function drawStars() {
        sCtx.clearRect(0,0,sCanvas.width, sCanvas.height);
        stars.forEach(s => {
            sCtx.globalAlpha = (Math.sin(s.t)+1)/2;
            sCtx.beginPath(); sCtx.arc(s.x, s.y, s.size, 0, 7); sCtx.fillStyle = "#fff"; sCtx.fill();
            s.t += s.speed;
        });
        requestAnimationFrame(drawStars);
    }
    initStars(); drawStars(); window.onresize = initStars; updateAll();
</script>
</body>
</html>
