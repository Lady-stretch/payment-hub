<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Lady Stretch | Monolith Supreme V10</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* =========================================
           –ú–û–î–£–õ–¨ ‚Ññ1: –Ø–î–†–û –î–ò–ó–ê–ô–ù–ê –ò –§–ò–ó–ò–ö–ê –§–û–ù–ê
           ========================================= */
        :root {
            --gold: #D4AF37;
            --gold-light: #F3E5AB;
            --gold-bright: #FFD700;
            --bg-dark: #000000;
            --panel-bg: rgba(0, 0, 0, 0.85);
            --border: rgba(212, 175, 55, 0.4);
            --text-main: #ffffff;
            --text-dim: rgba(255, 255, 255, 0.5);
            --danger: #FF3B30;
            --success: #34C759;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* –ú–ï–†–¢–í–´–ô –§–û–ù - –ù–ï –ì–£–õ–Ø–ï–¢ –ü–†–ò –°–ö–†–û–õ–õ–ï */
        .fixed-background {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('bg.jpg'); 
            background-size: cover;
            background-position: center;
            z-index: -1;
            transform: translateZ(0);
        }

        /* –õ–ê–ó–ï–†–ù–´–ô –°–ö–ê–ù–ï–† –ü–†–ò –ó–ê–ü–£–°–ö–ï */
        #monolith-loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000; display: flex; flex-direction: column;
            align-items: center; justify-content: center; transition: opacity 1s ease;
        }
        .laser-line {
            position: absolute; top: 0; left: 0; width: 100%; height: 3px;
            background: var(--gold); box-shadow: 0 0 20px var(--gold), 0 0 40px var(--gold);
            animation: verticalScan 3s infinite ease-in-out;
        }
        @keyframes verticalScan {
            0% { top: 0%; opacity: 0; }
            50% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        /* =========================================
           –ú–û–î–£–õ–¨ ‚Ññ2: –®–ê–ü–ö–ê –ò –°–ß–ï–¢–ß–ò–ö–ò
           ========================================= */
        header {
            position: sticky; top: 0; width: 100%; height: 85px;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-bottom: 2px solid var(--gold);
            z-index: 1000; display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px;
        }
        .brand-box h1 { font-size: 18px; font-weight: 300; letter-spacing: 4px; }
        .brand-box h1 b { color: var(--gold); font-weight: 900; }
        .brand-box p { font-size: 8px; font-weight: 900; color: var(--gold); letter-spacing: 2px; }

        .total-sessions { text-align: right; }
        .total-sessions .num { font-size: 32px; font-weight: 900; color: var(--gold); line-height: 1; }
        .total-sessions .lab { font-size: 7px; font-weight: 900; text-transform: uppercase; color: var(--text-dim); }

        /* =========================================
           –ú–û–î–£–õ–¨ ‚Ññ3: UI –≠–õ–ï–ú–ï–ù–¢–´ (–ö–û–ù–¢–†–ê–°–¢–ù–´–ï)
           ========================================= */
        .main-content { padding: 20px; max-width: 500px; margin: 0 auto; }

        .section-label {
            font-size: 11px; font-weight: 900; color: var(--gold);
            text-transform: uppercase; letter-spacing: 3px;
            margin: 30px 0 12px 5px; display: block;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.4);
        }

        .glass-panel {
            background: var(--panel-bg);
            border: 1px solid var(--border);
            border-radius: 22px; padding: 22px; margin-bottom: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.6);
        }

        /* –ë–ò–û–ú–ï–¢–†–ò–Ø –í –†–Ø–î */
        .bio-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }
        .bio-input-group { text-align: center; background: rgba(255,255,255,0.03); padding: 12px 5px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.05); }
        .bio-input-group label { font-size: 8px; font-weight: 900; color: var(--gold); display: block; margin-bottom: 8px; }
        .bio-input-group input { width: 100%; background: transparent; border: none; color: #fff; font-size: 24px; font-weight: 700; text-align: center; outline: none; }

        /* –°–ï–õ–ï–ö–¢–û–†–´ (–ö–ù–û–ü–ö–ò) */
        .selector-box { display: flex; gap: 8px; background: rgba(255,255,255,0.05); padding: 6px; border-radius: 16px; }
        .sel-item { flex: 1; padding: 16px 5px; font-size: 10px; font-weight: 900; text-align: center; border-radius: 12px; color: var(--text-dim); cursor: pointer; transition: 0.3s; text-transform: uppercase; }
        .sel-item.active { background: var(--gold); color: #000; box-shadow: 0 0 20px rgba(212, 175, 55, 0.4); }

        /* –≠–ö–°–ü–ï–†–¢–ù–û–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï */
        .expert-block {
            border-left: 4px solid var(--gold);
            background: rgba(212, 175, 55, 0.08);
            padding: 20px; border-radius: 0 20px 20px 0; margin: 20px 0;
        }
        .expert-block h5 { font-size: 9px; font-weight: 900; color: var(--gold); margin-bottom: 8px; }
        .expert-block p { font-size: 14px; font-weight: 400; line-height: 1.6; color: #fff; }

        /* –ú–ï–¢–†–ò–ö–ò */
        .metrics-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .metric-card { background: rgba(212, 175, 55, 0.1); border: 1px solid rgba(212, 175, 55, 0.2); border-radius: 18px; padding: 15px; text-align: center; }
        .metric-card .val { font-size: 24px; font-weight: 800; display: block; }
        .metric-card .unit { font-size: 8px; font-weight: 900; color: var(--gold); text-transform: uppercase; }

        /* –°–ï–¢–ö–ê –¢–†–ï–ù–ò–†–û–í–û–ö */
        .workout-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .workout-card {
            background: var(--panel-bg); border: 1px solid var(--border);
            border-radius: 20px; padding: 22px 15px; text-align: center; transition: 0.3s;
            display: flex; flex-direction: column; justify-content: center; min-height: 110px;
        }
        .workout-card.locked { opacity: 0.15; filter: grayscale(1); cursor: not-allowed; border-color: #333; }
        .workout-card h3 { font-size: 14px; font-weight: 700; margin-bottom: 6px; letter-spacing: 0.5px; }
        .workout-card .count { font-size: 9px; font-weight: 900; color: var(--gold); text-transform: uppercase; }

        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.96); backdrop-filter: blur(25px);
            z-index: 2000; display: none; align-items: center; justify-content: center; padding: 25px;
        }
        .modal-window {
            background: #111; border: 2px solid var(--gold); border-radius: 35px;
            padding: 40px 30px; width: 100%; max-width: 400px; text-align: center;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.2);
        }
        .btn-confirm {
            width: 100%; padding: 22px; background: var(--gold); color: #000;
            border: none; border-radius: 18px; font-weight: 900; font-size: 14px;
            text-transform: uppercase; margin-top: 30px; letter-spacing: 1px;
        }

        /* –î–ò–ü–õ–û–ú –ú–û–ù–û–õ–ò–¢–ê */
        #monolith-diploma {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10001; display: none; flex-direction: column;
            align-items: center; justify-content: center; padding: 40px; text-align: center;
            border: 15px solid var(--gold);
        }
        .diploma-title { font-size: 42px; font-weight: 900; color: var(--gold); letter-spacing: 10px; margin-bottom: 20px; }

        canvas { width: 100% !important; height: 180px !important; margin-top: 10px; }
    </style>
</head>
<body>

<div class="fixed-background"></div>

<div id="monolith-loader">
    <div class="laser-line"></div>
    <h2 style="font-weight: 100; letter-spacing: 12px; margin-bottom: 10px;">LADY STRETCH</h2>
    <p style="font-size: 9px; font-weight: 900; color: var(--gold); letter-spacing: 4px;">SYSTEM INITIALIZATION</p>
</div>

<header>
    <div class="brand-box">
        <h1>LADY <b>STRETCH</b></h1>
        <p>SYKTYVKAR MONOLITH</p>
    </div>
    <div class="total-sessions">
        <div id="display-total" class="num">0</div>
        <div class="lab">–°–ï–ê–ù–°–û–í</div>
    </div>
</header>

<div class="main-content">
    
    <span class="section-label">üß¨ –ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å</span>
    <div class="glass-panel">
        <div class="selector-box" style="margin-bottom: 20px;">
            <div class="sel-item active" id="gender-f" onclick="sys.updateGender('f')">–ñ–µ–Ω—â–∏–Ω–∞</div>
            <div class="sel-item" id="gender-m" onclick="sys.updateGender('m')">–ú—É–∂—á–∏–Ω–∞</div>
        </div>
        <div class="bio-row">
            <div class="bio-input-group">
                <label>–í–ï–° (–ö–ì)</label>
                <input type="number" id="inp-w" placeholder="00" oninput="sys.runCore()">
            </div>
            <div class="bio-input-group">
                <label>–†–û–°–¢ (–°–ú)</label>
                <input type="number" id="inp-h" placeholder="000" oninput="sys.runCore()">
            </div>
            <div class="bio-input-group">
                <label>–í–û–ó–†–ê–°–¢</label>
                <input type="number" id="inp-a" placeholder="00" oninput="sys.runCore()">
            </div>
        </div>
    </div>

    <span class="section-label">üîã –¢–µ–∫—É—â–∏–π —Ä–µ—Å—É—Ä—Å</span>
    <div class="glass-panel selector-box">
        <div class="sel-item" id="res-1" onclick="sys.updateResource('–°–ü–ê–î', 0.85, 1)">–°–ü–ê–î</div>
        <div class="sel-item active" id="res-2" onclick="sys.updateResource('–ù–û–†–ú–ê', 1.0, 2)">–ù–û–†–ú–ê</div>
        <div class="sel-item" id="res-3" onclick="sys.updateResource('–ü–ò–ö', 1.15, 3)">–ü–ò–ö</div>
    </div>

    <span class="section-label">üèÉ –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</span>
    <div class="glass-panel selector-box">
        <div class="sel-item active" id="acc-1" onclick="sys.updateActivity(1.2, 1)">–ù–∏–∑–∫–∞—è</div>
        <div class="sel-item" id="acc-2" onclick="sys.updateActivity(1.375, 2)">–°—Ä–µ–¥–Ω—è—è</div>
        <div class="sel-item" id="acc-3" onclick="sys.updateActivity(1.55, 3)">–í—ã—Å–æ–∫–∞—è</div>
        <div class="sel-item" id="acc-4" onclick="sys.updateActivity(1.9, 4)">MAX</div>
    </div>

    <div class="expert-block">
        <h5>–ê–ù–ê–õ–ò–ó –ë–ò–û–ú–ï–¢–†–ò–ò:</h5>
        <p id="expert-text">–û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Lady Stretch...</p>
    </div>

    <div class="metrics-grid">
        <div class="metric-card"><span id="out-bmi" class="val">--</span><span class="unit">–ò–ú–¢</span></div>
        <div class="metric-card"><span id="out-h2o" class="val">--</span><span class="unit">–í–æ–¥–∞ (–õ)</span></div>
        <div class="metric-card"><span id="out-kcal" class="val">--</span><span class="unit">–ö–∫–∞–ª/–¥–µ–Ω—å</span></div>
    </div>

    <span class="section-label">üßò –í—ã–±–æ—Ä –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (50 –º–∏–Ω—É—Ç)</span>
    <div class="workout-grid" id="workout-container">
        </div>

    <span class="section-label">üìà –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å</span>
    <div class="glass-panel">
        <canvas id="mainChart"></canvas>
    </div>

    <button onclick="sys.hardReset()" style="width: 100%; background: none; border: none; color: var(--danger); font-size: 9px; font-weight: 900; letter-spacing: 2px; margin-top: 50px; opacity: 0.4;">–û–ë–ù–£–õ–ò–¢–¨ –í–°–Æ –ò–°–¢–û–†–ò–Æ –≠–í–û–õ–Æ–¶–ò–ò</button>
</div>

<div id="modal-session" class="modal-overlay" onclick="sys.closeModal()">
    <div class="modal-window" onclick="event.stopPropagation()">
        <h2 id="m-title" style="color: var(--gold); text-transform: uppercase; margin-bottom: 15px;"></h2>
        <p id="m-info" style="line-height: 1.8; color: #ccc; font-size: 15px;"></p>
        <button class="btn-confirm" onclick="sys.logSession()">–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∞–Ω—Å</button>
    </div>
</div>

<div id="monolith-diploma" onclick="this.style.display='none'">
    <div class="diploma-title">–ú–û–ù–û–õ–ò–¢</div>
    <div style="width: 80px; height: 2px; background: var(--gold); margin: 20px 0;"></div>
    <h2 style="font-weight: 300; margin-bottom: 30px;">–í–´–°–®–ê–Ø –°–¢–£–ü–ï–ù–¨ –≠–í–û–õ–Æ–¶–ò–ò</h2>
    <p id="diploma-msg" style="font-size: 16px; line-height: 2; font-weight: 300; max-width: 300px;"></p>
    <p style="margin-top: 50px; font-size: 10px; color: var(--gold); letter-spacing: 4px;">LADY STRETCH SYKTYVKAR</p>
    <p style="font-size: 12px; font-weight: 800; margin-top: 10px;">–ù–∏–∫–æ–ª–∞–π –•—É–¥—è–∫–æ–≤ & –û–ª—å–≥–∞</p>
</div>

<script>
/* =========================================
   –ú–û–î–£–õ–¨ ‚Ññ4: –ö–û–ù–¢–ï–ù–¢–ù–ê–Ø –ú–ê–¢–†–ò–¶–ê (–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨)
   ========================================= */
const protocols = [
    { id: '1', n: '–ü–∏–ª–∞—Ç–µ—Å', type: 'soft', d: '–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–∏–Ω–≥ –¥–ª—è –æ—Å–∞–Ω–∫–∏. –ú—ã —É—á–∏–º –≤–∞—à–µ —Ç–µ–ª–æ –¥–≤–∏–≥–∞—Ç—å—Å—è —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–Ω–æ, —É–∫—Ä–µ–ø–ª—è—è –º—ã—à–µ—á–Ω—ã–π –∫–æ—Ä—Å–µ—Ç –±–µ–∑ –æ—Å–µ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.' },
    { id: '2', n: '–ú–§–†', type: 'soft', d: '–ú–∏–æ—Ñ–∞—Å—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑. –ì–ª—É–±–æ–∫–∞—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∞ —Ç–∫–∞–Ω–µ–π —Ä–æ–ª–ª–æ–º. –£–±–∏—Ä–∞–µ—Ç –∑–∞–∂–∏–º—ã, ¬´—Ä–∞–∑–≥–æ–Ω—è–µ—Ç¬ª –ª–∏–º—Ñ—É –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Å–Ω–∏–º–∞–µ—Ç –æ—Ç–µ—á–Ω–æ—Å—Ç—å.' },
    { id: '3', n: '–ó–¥–æ—Ä–æ–≤–∞—è —Å–ø–∏–Ω–∞', type: 'soft', d: '–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –°—ã–∫—Ç—ã–≤–∫–∞—Ä–∞. –°–Ω–∏–º–∞–µ–º –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ —Å –ø–æ—è—Å–Ω–∏—Ü—ã –∏ —à–µ–∏, –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –º–æ–±–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–Ω–∫–æ–≤.' },
    { id: '4', n: '–°—Ç—Ä–µ—Ç—á–∏–Ω–≥', type: 'soft', d: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –≥–∏–±–∫–æ—Å—Ç–∏. –ú—ã –¥–µ–ª–∞–µ–º –º—ã—à—Ü—ã —ç–ª–∞—Å—Ç–∏—á–Ω—ã–º–∏, –∞ —Å—É—Å—Ç–∞–≤—ã ‚Äî –º–æ–ª–æ–¥—ã–º–∏. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ª–µ–≥–∫–æ—Å—Ç–∏ –≤ —Ç–µ–ª–µ.' },
    { id: '5', n: 'Sky Stretching', type: 'soft', d: '–ê—ç—Ä–æ-—Ä–∞—Å—Ç—è–∂–∫–∞ –≤ –≥–∞–º–∞–∫–∞—Ö. –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤–∞—Å, –±–µ—Ä–µ–∂–Ω–æ –≤—ã—Ç—è–≥–∏–≤–∞—è –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫ –∏ –¥–∞—Ä—è –æ—â—É—â–µ–Ω–∏–µ –ø–æ–ª–µ—Ç–∞.' },
    { id: '6', n: '–ü–æ–¥–∫–∞—á–∫–∞ + –†–∞—Å—Ç—è–∂–∫–∞', type: 'hard', d: '–ò–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å: —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ–º –ø–ª–æ—Ç–Ω—ã–π –º—ã—à–µ—á–Ω—ã–π —Ä–µ–ª—å–µ—Ñ, –∑–∞—Ç–µ–º —Å—Ä–∞–∑—É —É–¥–ª–∏–Ω—è–µ–º –º—ã—à—Ü—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ü–∏–∏.' },
    { id: '7', n: '–Ø–≥–æ–¥–∏—Ü—ã + –ü—Ä–µ—Å—Å', type: 'hard', d: '–¢–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ —ç—Å—Ç–µ—Ç–∏–∫–æ–π. –§–æ—Ä–º–∏—Ä—É–µ–º –æ–∫—Ä—É–≥–ª—ã–µ —è–≥–æ–¥–∏—Ü—ã –∏ –ø–ª–æ—Å–∫–∏–π –∂–∏–≤–æ—Ç —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –±–∏–æ–º–µ—Ö–∞–Ω–∏–∫—É.' },
    { id: '8', n: '–ö—Ä—É–≥–æ–≤–∞—è', type: 'hard', d: '–ñ–∏—Ä–æ—Å–∂–∏–≥–∞—é—â–∏–π –∏–Ω—Ç–µ–Ω—Å–∏–≤. –í—ã—Å–æ–∫–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –±—ã—Å—Ç—Ä—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∑–µ—Ä–∫–∞–ª–µ.' },
    { id: '9', n: 'Body Sculpt', type: 'hard', d: '–°–∏–ª–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–µ—Ç–∫–∏—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤ –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ç–∫–∞–Ω–µ–π.' },
    { id: '10', n: '–¢–∞–±–∞—Ç–∞', type: 'hard', d: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–ª–∏–∫. –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–∏–Ω–≥ 20/10 –¥–ª—è —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–π ¬´—Å—É—à–∫–∏¬ª –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏.' },
    { id: '11', n: '–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª', type: 'hard', d: '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –¥–ª—è –∂–∏–∑–Ω–∏. –†–∞–∑–≤–∏–≤–∞–µ–º —Å–∏–ª—É, –±–∞–ª–∞–Ω—Å –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é, –¥–µ–ª–∞—è —Ç–µ–ª–æ –≥–æ—Ç–æ–≤—ã–º –∫ –ª—é–±—ã–º –Ω–∞–≥—Ä—É–∑–∫–∞–º.' },
    { id: '12', n: '–ô–æ–≥–∞ –†–µ–ª–∞–∫—Å', type: 'soft', d: '–ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ. –†–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ –≥–ª—É–±–æ–∫–æ–µ –¥—ã—Ö–∞–Ω–∏–µ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è —Å—Ç—Ä–µ—Å—Å–∞ –∏ –∫–æ—Ä—Ç–∏–∑–æ–ª–∞.' }
];

/* =========================================
   –ú–û–î–£–õ–¨ ‚Ññ5: –õ–û–ì–ò–ö–ê –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø (CORE)
   ========================================= */
class MonolithSupreme {
    constructor() {
        this.data = JSON.parse(localStorage.getItem('ls_monolith_v10')) || {
            gender: 'f', weight: '', height: '', age: '',
            actVal: 1.2, actIdx: 1, resVal: 1.0, resIdx: 2, resName: '–ù–û–†–ú–ê',
            logs: {}, history: [0,0,0,0,0,0,0]
        };
        this.activeP = null;
        this.init();
    }

    init() {
        // –£–±–∏—Ä–∞–µ–º –ª–æ–∞–¥–µ—Ä
        setTimeout(() => {
            document.getElementById('monolith-loader').style.opacity = '0';
            setTimeout(() => document.getElementById('monolith-loader').style.display = 'none', 1000);
        }, 2500);

        // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è
        document.getElementById('inp-w').value = this.data.weight;
        document.getElementById('inp-h').value = this.data.height;
        document.getElementById('inp-a').value = this.data.age;

        this.updateGender(this.data.gender);
        this.updateActivity(this.data.actVal, this.data.actIdx);
        this.updateResource(this.data.resName, this.data.resVal, this.data.resIdx);
        
        this.renderProtocols();
        this.runCore();
        this.renderChart();
    }

    updateGender(g) {
        this.data.gender = g;
        document.getElementById('gender-f').classList.toggle('active', g === 'f');
        document.getElementById('gender-m').classList.toggle('active', g === 'm');
        this.runCore();
    }

    updateActivity(v, i) {
        this.data.actVal = v; this.data.actIdx = i;
        for(let j=1; j<=4; j++) document.getElementById('acc-'+j).classList.remove('active');
        document.getElementById('acc-'+i).classList.add('active');
        this.runCore();
    }

    updateResource(name, val, idx) {
        this.data.resName = name; this.data.resVal = val; this.data.resIdx = idx;
        for(let j=1; j<=3; j++) document.getElementById('res-'+j).classList.remove('active');
        document.getElementById('res-'+idx).classList.add('active');
        this.runCore();
        this.renderProtocols(); // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–∞—Ä—Ç
    }

    runCore() {
        const w = parseFloat(document.getElementById('inp-w').value);
        const h = parseFloat(document.getElementById('inp-h').value);
        const a = parseInt(document.getElementById('inp-a').value);

        if (w && h && a) {
            this.data.weight = w; this.data.height = h; this.data.age = a;
            
            // –ò–ú–¢
            const bmi = (w / ((h/100)**2)).toFixed(1);
            document.getElementById('out-bmi').innerText = bmi;
            
            // –í–æ–¥–∞
            document.getElementById('out-h2o').innerText = (w * 0.035).toFixed(1);
            
            // –ö–∞–ª–æ—Ä–∏–∏ (–ú–∏—Ñ—Ñ–ª–∏–Ω-–°–∞–Ω –ñ–µ–æ—Ä)
            let bmr = (10 * w) + (6.25 * h) - (5 * a) + (this.data.gender === 'm' ? 5 : -161);
            let totalKcal = Math.round(bmr * this.data.actVal * this.data.resVal);
            document.getElementById('out-kcal').innerText = totalKcal;

            // –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π —Å–æ–≤–µ—Ç
            const exp = document.getElementById('expert-text');
            if (this.data.resName === '–°–ü–ê–î') {
                exp.innerHTML = "<b>–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –†–ï–°–£–†–°:</b> –í–∞—à –æ—Ä–≥–∞–Ω–∏–∑–º —Ç—Ä–µ–±—É–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è. –°–∏–ª–æ–≤—ã–µ –∏ –∂–∏—Ä–æ—Å–∂–∏–≥–∞—é—â–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –ø–µ—Ä–µ—É—Ç–æ–º–ª–µ–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ú–§–†.";
            } else if (bmi > 25) {
                exp.innerHTML = "<b>–ê–ù–ê–õ–ò–ó:</b> –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–ø–∏–¥–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Ç–æ–∫–æ–ª –¢–∞–±–∞—Ç–∞ –∏–ª–∏ –ö—Ä—É–≥–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –¥–ª—è —Ä–∞–∑–≥–æ–Ω–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞.";
            } else {
                exp.innerHTML = "<b>–ê–ù–ê–õ–ò–ó:</b> –¢–µ–ª–æ –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–∏–æ–¥ –ù–û–†–ú–ê –¥–ª—è —É–≥–ª—É–±–ª–µ–Ω–∏—è —Ä–∞—Å—Ç—è–∂–∫–∏ –≤ Sky Stretching.";
            }
            this.save();
        }
    }

    renderProtocols() {
        const container = document.getElementById('workout-container');
        container.innerHTML = '';
        
        protocols.forEach(p => {
            const count = this.data.logs[p.id] || 0;
            const isLocked = (this.data.resName === '–°–ü–ê–î' && p.type === 'hard');
            
            const card = document.createElement('div');
            card.className = `workout-card ${isLocked ? 'locked' : ''}`;
            card.innerHTML = `<h3>${p.n}</h3><div class="count">${count} –°–ï–ê–ù–°–û–í</div>`;
            card.onclick = () => this.openModal(p.id, isLocked);
            container.appendChild(card);
        });

        const total = Object.values(this.data.logs).reduce((a, b) => a + b, 0);
        document.getElementById('display-total').innerText = total;
        
        if (total >= 150) this.showDiploma();
    }

    openModal(id, locked) {
        if (locked) {
            Telegram.WebApp.showPopup({
                title: '–†–µ—Å—É—Ä—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω',
                message: '–ü—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –°–ü–ê–î –≤—ã—Å–æ–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø—Ä–µ—â–µ–Ω—ã. –í—ã–±–µ—Ä–∏—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª.',
                buttons: [{type: 'close'}]
            });
            return;
        }
        this.activeP = id;
        const p = protocols.find(x => x.id === id);
        document.getElementById('m-title').innerText = p.n;
        document.getElementById('m-info').innerText = p.d;
        document.getElementById('modal-session').style.display = 'flex';
    }

    closeModal() { document.getElementById('modal-session').style.display = 'none'; }

    logSession() {
        this.data.logs[this.activeP] = (this.data.logs[this.activeP] || 0) + 1;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        const day = new Date().getDay(); 
        const dayIdx = day === 0 ? 6 : day - 1; 
        this.data.history[dayIdx]++;
        
        window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
        this.save();
        this.renderProtocols();
        this.renderChart();
        this.closeModal();
    }

    showDiploma() {
        const d = document.getElementById('monolith-diploma');
        document.getElementById('diploma-msg').innerText = "–ù–∏–∫–æ–ª–∞–π –∏ –û–ª—å–≥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç: –í—ã –ø—Ä–æ—à–ª–∏ 150 —Å—Ç—É–ø–µ–Ω–µ–π —ç–≤–æ–ª—é—Ü–∏–∏ –≤ Lady Stretch –°—ã–∫—Ç—ã–≤–∫–∞—Ä. –í–∞—à–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî –ú–û–ù–û–õ–ò–¢. –í–∞—à–µ —Ç–µ–ª–æ ‚Äî —ç—Ç–∞–ª–æ–Ω –≥–∏–±–∫–æ—Å—Ç–∏ –∏ —Å–∏–ª—ã.";
        d.style.display = 'flex';
    }

    renderChart() {
        const ctx = document.getElementById('mainChart').getContext('2d');
        if (this.chartObj) this.chartObj.destroy();
        this.chartObj = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['–ü–ù', '–í–¢', '–°–†', '–ß–¢', '–ü–¢', '–°–ë', '–í–°'],
                datasets: [{
                    label: '–ó–∞–Ω—è—Ç–∏–π',
                    data: this.data.history,
                    backgroundColor: '#D4AF37',
                    borderRadius: 8
                }]
            },
            options: {
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#D4AF37', stepSize: 1 } },
                    x: { grid: { display: false }, ticks: { color: '#fff' } }
                }
            }
        });
    }

    save() { localStorage.setItem('ls_monolith_v10', JSON.stringify(this.data)); }
    
    hardReset() {
        if (confirm("–í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç –≤–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å. –°–±—Ä–æ—Å–∏—Ç—å?")) {
            localStorage.removeItem('ls_monolith_v10');
            location.reload();
        }
    }
}

const sys = new MonolithSupreme();
</script>
</body>
</html>
