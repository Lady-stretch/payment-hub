<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Monolith V6.7 | TOTAL ELITE SYSTEM</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;500;700;800;900&display=swap" rel="stylesheet">
    
<style>
        :root {
            --glass-border: rgba(255, 255, 255, 0.22);
            --accent: #ffffff;
            --text-main: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.55);
            --success: #32d74b;
            --gold: #ffd700;
            --danger: #ff3b30;
            --neon-glow: 0 0 25px rgba(255, 255, 255, 0.15);
        }

        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            margin: 0; padding: 0; 
        }
        
        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-main);
            background: #000 url('bg.jpg') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            padding-bottom: 120px;
            overflow-x: hidden;
            /* –£–º–µ–Ω—å—à–∞–µ–º –º–∞—Å—à—Ç–∞–± –≤—Å–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ 10%, –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª */
            zoom: 0.92;
            -moz-transform: scale(0.92);
            -moz-transform-origin: 0 0;
        }

        /* –ö–ò–ù–ï–ú–ê–¢–û–ì–†–ê–§–ò–ß–ù–´–ô –ü–†–ï–î–ó–ê–ì–†–£–ó–ß–ò–ö */
        #preloader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000;
            display: flex; align-items: center; justify-content: center;
            transition: opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .intro-title {
            font-weight: 900; letter-spacing: 25px; font-size: 34px; color: #fff;
            text-transform: uppercase; animation: cinematic 4.5s ease-in-out forwards;
            text-align: center;
        }
        @keyframes cinematic {
            0% { opacity: 0; letter-spacing: 5px; transform: scale(0.8); filter: blur(20px); }
            45% { opacity: 1; letter-spacing: 25px; transform: scale(1); filter: blur(0); }
            80% { opacity: 1; transform: scale(1.05); }
            100% { opacity: 0; transform: translateY(-50px) scale(1.1); }
        }

        header {
            position: sticky; top: 0; width: 100%; height: 95px;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(40px); -webkit-backdrop-filter: blur(40px);
            z-index: 1000; display: flex; align-items: center; justify-content: space-between; padding: 0 30px;
            border-bottom: 1px solid var(--glass-border);
        }

        .container { max-width: 520px; margin: 0 auto; padding: 25px; }

        /* –ó–ê–ì–û–õ–û–í–ö–ò –°–ï–ö–¶–ò–ô */
        .section-label { 
            font-size: 14px; font-weight: 900; text-transform: uppercase; letter-spacing: 4px; 
            color: #fff; margin: 50px 0 25px 5px; display: block;
        }

        /* –≠–§–§–ï–ö–¢ –°–¢–ï–ö–õ–Ø–ù–ù–û–ô –õ–ò–ù–ó–´ –ò –ö–†–û–ú–ö–ò (–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –û–ë–™–ï–ú) */
        .glass-panel {
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid var(--glass-border);
            border-radius: 32px;
            position: relative;
            box-shadow: 0 15px 45px rgba(0,0,0,0.5), inset 0 0 20px rgba(255,255,255,0.05);
            overflow: hidden;
            transition: 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        .glass-panel::before {
            content: ""; position: absolute; top: 0; left: 0; right: 0; height: 1.5px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.45), transparent);
            z-index: 2;
        }
        .glass-panel::after {
            content: ""; position: absolute; top: 0; left: 0; width: 1.5px; bottom: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0.35), transparent);
            z-index: 2;
        }

        /* –í–´–ë–û–† –ü–û–õ–ê */
        .gender-selector { display: flex; gap: 15px; margin-bottom: 25px; }
        .gen-btn {
            flex: 1; padding: 24px; text-align: center; font-size: 13px; font-weight: 900;
            text-transform: uppercase; border-radius: 22px; cursor: pointer; transition: 0.4s;
            color: var(--text-muted); background: rgba(255,255,255,0.06); border: 1px solid var(--glass-border);
        }
        .gen-btn.active { 
            background: #fff; color: #000; border-color: #fff; 
            box-shadow: 0 0 35px rgba(255,255,255,0.4);
        }

        /* –¢–†–ò–ì–ì–ï–† –ê–ö–¢–ò–í–ù–û–°–¢–ò */
        .act-trigger {
            width: 100%; padding: 26px; font-size: 12px; font-weight: 900; text-transform: uppercase;
            letter-spacing: 2px; color: #fff; margin-bottom: 40px; cursor: pointer; text-align: center;
        }

        /* –ü–û–õ–Ø –í–í–û–î–ê –î–ê–ù–ù–´–• */
        .bio-row { display: flex; gap: 18px; margin-bottom: 40px; }
        .g-input-wrap { flex: 1; }
        .g-input {
            width: 100%; background: rgba(255,255,255,0.12); border: 1px solid var(--glass-border);
            border-radius: 26px; padding: 24px 5px; color: #fff; text-align: center; 
            font-size: 26px; font-weight: 700; outline: none; transition: 0.3s;
        }
        .g-input:focus { border-color: #fff; background: rgba(255,255,255,0.18); box-shadow: 0 0 20px rgba(255,255,255,0.1); }

        /* –û–°–ù–û–í–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ */
        .results-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 18px; margin-bottom: 30px; }
        .res-item { text-align: center; padding: 28px 10px; border-radius: 35px; }
        .res-val { font-size: 28px; font-weight: 900; display: block; color: #fff; margin-bottom: 6px; }
        .res-lbl { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1.5px; }
        
        /* –ò–ú–¢ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï */
        #bmi-status { 
            font-size: 15px; line-height: 1.8; padding: 28px;
            background: rgba(255,255,255,0.08); border-radius: 35px; margin-bottom: 45px;
            border-left: 10px solid var(--success); transition: 0.6s;
        }

        /* –ë–ñ–£ –ü–õ–ê–ù –ù–ê 24 –ß–ê–°–ê */
        .pfc-box { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 18px; margin-bottom: 50px; }
        .pfc-item { padding: 24px 10px; border-radius: 32px; text-align: center; }
        .pfc-val { font-size: 24px; font-weight: 900; display: block; color: var(--gold); }
        .pfc-lbl { font-size: 10px; color: var(--text-muted); text-transform: uppercase; margin-top: 6px; }

        /* –í–´–ë–û–† –†–ï–°–£–†–°–ê */
        .energy-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 18px; }
        .liquid-btn {
            width: 100%; padding: 24px 0; border-radius: 32px; text-align: center; color: #fff;
            font-size: 14px; font-weight: 900; text-transform: uppercase; transition: 0.4s;
        }
        .liquid-btn.active { background: #fff; color: #000; box-shadow: 0 15px 40px rgba(255,255,255,0.35); }

        /* –¢–†–ï–ù–ò–†–û–í–ö–ò (–°–ï–¢–ö–ê) */
        .workout-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .w-card {
            padding: 30px 22px; min-height: 160px; display: flex; flex-direction: column; justify-content: space-between;
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); cursor: pointer;
        }
        .w-card:active { transform: scale(0.95); }
        .w-card.dimmed { opacity: 0.15; filter: grayscale(1); pointer-events: none; }
        .w-name { font-size: 18px; font-weight: 800; line-height: 1.35; letter-spacing: -0.5px; }
        .w-count { font-size: 11px; color: var(--text-muted); text-transform: uppercase; margin-top: 12px; font-weight: 700; }

        /* –ó–û–õ–û–¢–û–ô –°–ï–†–¢–ò–§–ò–ö–ê–¢ */
        #cert-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); z-index: 10000; display: none; align-items: center; justify-content: center;
            padding: 25px;
        }
        .cert-card {
            background: linear-gradient(145deg, #1c1c1c, #000);
            border: 3px solid var(--gold); border-radius: 50px; padding: 55px 35px;
            text-align: center; box-shadow: 0 0 70px rgba(255, 215, 0, 0.3);
            max-width: 440px; position: relative;
        }
        .cert-card::after {
            content: "LADY STRETCH ELITE"; position: absolute; bottom: 20px; right: 40px;
            font-size: 10px; font-weight: 900; color: rgba(255,215,0,0.3); letter-spacing: 2px;
        }
        .cert-title { font-size: 28px; font-weight: 900; color: var(--gold); margin: 25px 0; text-transform: uppercase; }
        .cert-body { font-size: 15px; line-height: 1.9; color: #f0f0f0; margin-bottom: 40px; text-align: left; }

        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê (–ê–ö–¢–ò–í–ù–û–°–¢–¨ / –î–ï–¢–ê–õ–ò) */
        #modal, #act-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.94); backdrop-filter: blur(50px); z-index: 9000; 
            display: none; align-items: center; justify-content: center;
        }
        .m-content { 
            width: 90%; max-width: 440px; background: #000; border: 1px solid #333; 
            border-radius: 55px; padding: 50px; position: relative;
        }
        .act-option {
            width: 100%; padding: 30px; background: rgba(255,255,255,0.06); border-radius: 35px;
            margin-bottom: 18px; border: 1px solid var(--glass-border); color: #fff; text-align: left;
            transition: 0.3s;
        }
        .act-option:active { background: #fff; color: #000; }

        .btn-reset {
            background: rgba(255, 59, 48, 0.08); border: 2.5px solid var(--danger); 
            color: var(--danger); padding: 24px 60px; border-radius: 45px; 
            font-size: 14px; font-weight: 900; text-transform: uppercase; margin: 80px 0;
        }

        /* –ì–†–ê–§–ò–ö–ò */
        .chart-container { padding: 30px; margin-top: 25px; }
    </style>
</head>
<body>

<div id="preloader"><div class="intro-title">Evolution Monolith</div></div>

<header>
    <div style="font-weight:900; font-size:26px; letter-spacing:2px; color:#fff;">LADY STRETCH</div>
    <div style="text-align: right;">
        <span id="head-total" style="font-size:44px; font-weight:100; line-height:1; color:var(--gold);">0</span>
        <span style="font-size:10px; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px;">Sessions</span>
    </div>
</header>

<div class="container">
    
    <div class="section-label">–í–∞—à –ü—Ä–æ—Ñ–∏–ª—å –∏ –†–∏—Ç–º</div>
    
    <div class="gender-selector">
        <div class="gen-btn active" id="gen-m" onclick="updateGender('m')">–ú—É–∂—á–∏–Ω–∞</div>
        <div class="gen-btn" id="gen-f" onclick="updateGender('f')">–ñ–µ–Ω—â–∏–Ω–∞</div>
    </div>
    
    <div class="act-trigger glass-panel" onclick="showActMenu()">
        –†–∏—Ç–º: <span id="act-label" style="color:var(--gold)">–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</span>
    </div>

    <div class="bio-row">
        <div class="g-input-wrap"><input type="number" id="w-in" class="g-input glass-panel" placeholder="–í–µ—Å" oninput="calculate()"></div>
        <div class="g-input-wrap"><input type="number" id="h-in" class="g-input glass-panel" placeholder="–†–æ—Å—Ç" oninput="calculate()"></div>
        <div class="g-input-wrap"><input type="number" id="a-in" class="g-input glass-panel" placeholder="–õ–µ—Ç" oninput="calculate()"></div>
    </div>
    
    <div class="results-grid">
        <div class="res-item glass-panel"><span class="res-val" id="bmi-val">--</span><span class="res-lbl">–ò–ú–¢</span></div>
        <div class="res-item glass-panel"><span class="res-val" id="h2o-val">--</span><span class="res-lbl">–í–æ–¥–∞ (–ª)</span></div>
        <div class="res-item glass-panel"><span class="res-val" id="bmr-val">--</span><span class="res-lbl">–ö–∫–∞–ª/–¥–µ–Ω—å</span></div>
    </div>
    
    <div id="bmi-status" class="glass-panel">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ò–ò-–∞–Ω–∞–ª–∏–∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∞—à–µ–≥–æ –æ—Ä–≥–∞–Ω–∏–∑–º–∞...</div>

    <div class="section-label">–ù—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥–∏—è: –ü–ª–∞–Ω –Ω–∞ 24 —á–∞—Å–∞</div>
    <div class="pfc-box">
        <div class="pfc-item glass-panel">
            <span class="pfc-val" id="p-val">--</span>
            <span class="pfc-lbl">–ë–µ–ª–∫–∏ (–≥)</span>
        </div>
        <div class="pfc-item glass-panel">
            <span class="pfc-val" id="f-val">--</span>
            <span class="pfc-lbl">–ñ–∏—Ä—ã (–≥)</span>
        </div>
        <div class="pfc-item glass-panel">
            <span class="pfc-val" id="c-val">--</span>
            <span class="pfc-lbl">–£–≥–ª–µ–≤–æ–¥—ã (–≥)</span>
        </div>
    </div>

    <div class="section-label">–í–∞—à –†–µ—Å—É—Ä—Å —Å–µ–≥–æ–¥–Ω—è</div>
    <div class="energy-row">
        <div class="e-col" onclick="setEnergy('low')">
            <div class="liquid-btn glass-panel" id="e-low">–°–ø–∞–¥</div>
        </div>
        <div class="e-col" onclick="setEnergy('mid')">
            <div class="liquid-btn glass-panel active" id="e-mid">–ë–∞–ª–∞–Ω—Å</div>
        </div>
        <div class="e-col" onclick="setEnergy('high')">
            <div class="liquid-btn glass-panel" id="e-high">–ü–∏–∫</div>
        </div>
    </div>

    <div class="section-label">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã Lady Stretch</div>
    <div class="workout-grid" id="w-grid"></div>

    <div class="section-label">–î–∏–Ω–∞–º–∏–∫–∞ –≤–µ—Å–∞ (–ü—Ä–æ–≥—Ä–µ—Å—Å)</div>
    <div class="glass-panel chart-container">
        <canvas id="mainChart" height="200"></canvas>
    </div>

    <center><button class="btn-reset" onclick="fullReset()">–°–±—Ä–æ—Å–∏—Ç—å —Å–∏—Å—Ç–µ–º—É</button></center>
</div>

<div id="cert-modal" onclick="this.style.display='none'">
    <div class="cert-card" onclick="event.stopPropagation()">
        <span style="font-size:70px; filter: drop-shadow(0 0 15px gold);">üèÜ</span>
        <div class="cert-title">–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –ó–∞–ø—É—â–µ–Ω–∞</div>
        <div class="cert-body" id="cert-text"></div>
        <button style="width:100%; padding:24px; background:var(--gold); color:#000; border:none; border-radius:30px; font-weight:900; font-size:16px; letter-spacing:1px;" onclick="document.getElementById('cert-modal').style.display='none'">–ü–†–û–î–û–õ–ñ–ò–¢–¨ –≠–í–û–õ–Æ–¶–ò–Æ</button>
    </div>
</div>

<div id="act-modal" onclick="hideActMenu()">
    <div class="m-content" onclick="event.stopPropagation()">
        <div style="font-size:28px; font-weight:900; margin-bottom:35px; text-align:center;">–í–∞—à–∞ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å?</div>
        <div class="act-option" onclick="setPAL(1.2, '–ù–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å')">
            <span style="font-weight:900; font-size:19px; display:block;">–ù–ò–ó–ö–ê–Ø</span>
            <span style="font-size:13px; color:#888;">–°–∏–¥—è—á–∏–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏, —à–∞–≥–∏ –º–µ–Ω–µ–µ 5000 –≤ –¥–µ–Ω—å.</span>
        </div>
        <div class="act-option" onclick="setPAL(1.55, '–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å')">
            <span style="font-weight:900; font-size:19px; display:block;">–°–†–ï–î–ù–Ø–Ø (LADY STRETCH)</span>
            <span style="font-size:13px; color:#888;">2-3 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –Ω–µ–¥–µ–ª—é + –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≥—É–ª–∫–∏.</span>
        </div>
        <div class="act-option" onclick="setPAL(1.9, '–í–´–°–û–ö–ê–Ø / –ê–¢–õ–ï–¢')">
            <span style="font-weight:900; font-size:19px; display:block;">–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø</span>
            <span style="font-size:13px; color:#888;">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π —Å–ø–æ—Ä—Ç –∏–ª–∏ —Ç—è–∂–µ–ª—ã–π —Ç—Ä—É–¥.</span>
        </div>
    </div>
</div>

<div id="modal" onclick="hideWModal()">
    <div class="m-content" onclick="event.stopPropagation()">
        <div id="m-title" style="font-size:30px; font-weight:900; margin-bottom:25px;"></div>
        <div id="m-desc" style="font-size:16px; color:#ccc; line-height:1.8; border-left:5px solid #fff; padding-left:25px; margin-bottom:40px;"></div>
        <button style="width:100%; padding:26px; background:#fff; color:#000; border:none; border-radius:32px; font-weight:900; font-size:16px;" onclick="logSession()">–ü–û–î–¢–í–ï–†–î–ò–¢–¨ –°–ï–°–°–ò–Æ</button>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–•
    let user = JSON.parse(localStorage.getItem('monolith_6_7_total')) || {
        gender: 'm',
        weight: '',
        height: '',
        age: 44,
        pal: 1.55,
        palName: '–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
        logs: {},
        dates: [],
        weightHistory: { v: [], d: [] }
    };

    // –ü–û–õ–ù–ê–Ø –ë–ê–ó–ê –¢–†–ï–ù–ò–†–û–í–û–ö (–ë–ï–ó –°–û–ö–†–ê–©–ï–ù–ò–ô)
    const workoutDatabase = [
        { id:'mfr', n:'–ú–§–† –¢–µ—Ä–∞–ø–∏—è', type:'low', desc:'–≠–∫—Å–ø–µ—Ä—Ç–Ω–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ —Ñ–∞—Å—Ü–∏–∏. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫, –∑–∞–ø—É—Å–∫ –ª–∏–º—Ñ–æ—Ç–æ–∫–∞ –∏ –≥–ª—É–±–æ–∫–∞—è –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—è –º—ã—à—Ü –ø–æ—Å–ª–µ —Å—Ç—Ä–µ—Å—Å–∞.' },
        { id:'back', n:'–ó–¥–æ—Ä–æ–≤–∞—è —Å–ø–∏–Ω–∞', type:'low', desc:'–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –±–∏–æ–º–µ—Ö–∞–Ω–∏–∫–∏ –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞. –£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –º—ã—à–µ—á–Ω–æ–≥–æ –∫–æ—Ä—Å–µ—Ç–∞, —Å–Ω—è—Ç–∏–µ –∑–∞–∂–∏–º–æ–≤ –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –≥—Ä—ã–∂.' },
        { id:'yoga', n:'–ô–æ–≥–∞ –†–µ–ª–∞–∫—Å', type:'low', desc:'–ù–µ–π—Ä–æ—Å–µ–¥–∞—Ç–∏–≤–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞. –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—Ç—è–∂–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥—ã—Ö–∞–Ω–∏—è –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –∫–æ—Ä—Ç–∏–∑–æ–ª–∞ –∏ –±–∞–ª–∞–Ω—Å–∞ –¶–ù–°.' },
        { id:'str', n:'–°—Ç—Ä–µ—Ç—á–∏–Ω–≥', type:'low', desc:'–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ —ç–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å—é —Å–≤—è–∑–æ—á–Ω–æ–≥–æ –∞–ø–ø–∞—Ä–∞—Ç–∞. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∞–º–ø–ª–∏—Ç—É–¥—ã –¥–≤–∏–∂–µ–Ω–∏–π –∏ –ª–µ–≥–∫–æ—Å—Ç—å –≤ —Ç–µ–ª–µ.' },
        { id:'sky', n:'Sky Stretch', type:'mid', desc:'–ê–Ω—Ç–∏–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞ –≤ –≥–∞–º–∞–∫–∞—Ö. –î–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ –≤—ã—Ç—è–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞ –∏ —Ä–∞–±–æ—Ç–∞ —Å –≤–µ—Å—Ç–∏–±—É–ª—è—Ä–Ω—ã–º –∞–ø–ø–∞—Ä–∞—Ç–æ–º.' },
        { id:'split', n:'–®–ø–∞–≥–∞—Ç', type:'mid', desc:'–¶–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ –ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å —Ç–∞–∑–æ–±–µ–¥—Ä–µ–Ω–Ω—ã—Ö —Å—É—Å—Ç–∞–≤–æ–≤. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –º–µ—Ç–æ–¥–∏–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —à–ø–∞–≥–∞—Ç–∞ —Å –Ω—É–ª—è.' },
        { id:'pil', n:'–ü–∏–ª–∞—Ç–µ—Å', type:'mid', desc:'–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è Core-–º—ã—à—Ü. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥–µ–∞–ª—å–Ω–æ–π –æ—Å–∞–Ω–∫–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å–∏–ª—ã —á–µ—Ä–µ–∑ –≥–ª—É–±–æ–∫—É—é –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é.' },
        { id:'circ', n:'–ö—Ä—É–≥–æ–≤–∞—è', type:'mid', desc:'–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∂–∏—Ä–æ—Å–∂–∏–≥–∞—é—â–∏–π —Ç—Ä–µ–Ω–∏–Ω–≥ –≤ —É–º–µ—Ä–µ–Ω–Ω–æ–º —Ç–µ–º–ø–µ. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è —É–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã.' },
        { id:'tab', n:'–¢–∞–±–∞—Ç–∞', type:'high', desc:'–ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π –≤–∑—Ä—ã–≤. –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –≤—ã—Å–æ–∫–æ–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏–π –∏ —Å–∂–∏–≥–∞–Ω–∏—è –∂–∏—Ä–∞.' },
        { id:'scu', n:'Body Sculpt', type:'high', desc:'–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ–ª–∞. –°–∏–ª–æ–≤–∞—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∞ –º—ã—à–µ—á–Ω–æ–≥–æ —Ä–µ–ª—å–µ—Ñ–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.' },
        { id:'trx', n:'TRX –ü–µ—Ç–ª–∏', type:'high', desc:'–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–∏–Ω–≥. –†–∞–∑–≤–∏—Ç–∏–µ –≤–∑—Ä—ã–≤–Ω–æ–π —Å–∏–ª—ã, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–µ—Å–∞.' },
        { id:'glute', n:'–Ø–≥–æ–¥–∏—Ü—ã + –ü—Ä–µ—Å—Å', type:'high', desc:'–ê–∫—Ü–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –∫–ª—é—á–µ–≤—ã–º–∏ –∑–æ–Ω–∞–º–∏. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ—â–Ω–æ–≥–æ —Å–∏–ª–æ–≤–æ–≥–æ –∫–∞—Ä–∫–∞—Å–∞ –∏ —ç—Å—Ç–µ—Ç–∏–∫–∏ —Ç–µ–ª–∞.' }
    ];

    let currentEnergy = 'mid';
    let activeWId = null;

    window.onload = () => {
        // –ó–∞–ø—É—Å–∫ –∑–∞—Å—Ç–∞–≤–∫–∏
        setTimeout(() => {
            document.getElementById('preloader').style.opacity = '0';
            setTimeout(() => document.getElementById('preloader').style.display='none', 1500);
        }, 3000);

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π
        document.getElementById('w-in').value = user.weight;
        document.getElementById('h-in').value = user.height;
        document.getElementById('a-in').value = user.age;
        document.getElementById('act-label').innerText = user.palName;
        
        updateGender(user.gender);
        renderWorkouts();
        updateCharts();
        calculate();
    };

    function updateGender(g) {
        user.gender = g;
        document.getElementById('gen-m').classList.toggle('active', g === 'm');
        document.getElementById('gen-f').classList.toggle('active', g === 'f');
        calculate(); save();
    }

    function showActMenu() { document.getElementById('act-modal').style.display = 'flex'; }
    function hideActMenu() { document.getElementById('act-modal').style.display = 'none'; }
    
    function setPAL(val, name) {
        user.pal = val;
        user.palName = name;
        document.getElementById('act-label').innerText = name;
        hideActMenu();
        calculate(); save();
    }

    function calculate() {
        const w = parseFloat(document.getElementById('w-in').value);
        const h = parseFloat(document.getElementById('h-in').value);
        const a = parseInt(document.getElementById('a-in').value);

        if (w > 0 && h > 0 && a > 0) {
            user.weight = w; user.height = h; user.age = a;
            
            // –ò–ú–¢
            const bmi = (w / ((h/100)**2)).toFixed(1);
            document.getElementById('bmi-val').innerText = bmi;

            // –°–¢–ê–¢–£–° –ò –°–ê–•–ê–†
            let status = "";
            let color = "var(--success)";
            
            if (user.pal <= 1.2) {
                if (bmi > 25) { 
                    status = `–ò–ú–¢ ${bmi}: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞ –ø—Ä–∏ —Å–∏–¥—è—á–µ–º –æ–±—Ä–∞–∑–µ –∂–∏–∑–Ω–∏. –†–∏—Å–∫ –∑–∞—Å—Ç–æ—è –ª–∏–º—Ñ—ã. –ò—Å–∫–ª—é—á–∏—Ç–µ —Å–∞—Ö–∞—Ä –Ω–∞ 90% –∏ –±—ã—Å—Ç—Ä—ã–µ —É–≥–ª–µ–≤–æ–¥—ã. –°—Ä–æ—á–Ω–æ –Ω–∞ –ú–§–†!`; 
                    color = "var(--danger)";
                } else { status = "–í–µ—Å –≤ –Ω–æ—Ä–º–µ, –Ω–æ —Ç–∫–∞–Ω–∏ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –∫–∏—Å–ª–æ—Ä–æ–¥–µ. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º Sky Stretch –¥–ª—è —Ä–∞–∑–≥—Ä—É–∑–∫–∏."; }
            } else if (user.pal >= 1.9) {
                status = "–í—ã—Å–æ–∫–∏–π –º–µ—Ç–∞–±–æ–ª–∏–∑–º! –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–µ–ª–∫–∞.";
            } else {
                status = bmi < 25 ? "–í—ã –≤ –∏–¥–µ–∞–ª—å–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ. –ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ Lady Stretch!" : "–ù–µ–±–æ–ª—å—à–æ–π –∏–∑–ª–∏—à–µ–∫. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –¢–∞–±–∞—Ç—É –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∞—Ö–∞—Ä–∞ –¥–ª—è —Å—É—à–∫–∏.";
            }
            const stEl = document.getElementById('bmi-status');
            stEl.innerText = status; stEl.style.borderLeftColor = color;

            // –ö–ö–ê–õ (–ú–ò–§–§–õ–ò–ù)
            let bmr = (10 * w) + (6.25 * h) - (5 * a) + (user.gender === 'm' ? 5 : -161);
            const totalKcal = Math.round(bmr * user.pal);
            document.getElementById('bmr-val').innerText = totalKcal;

            // –í–û–î–ê
            document.getElementById('h2o-val').innerText = (w * (user.pal > 1.5 ? 0.04 : 0.033)).toFixed(1);

            // –ë–ñ–£ (24 –ß–ê–°–ê)
            const p = Math.round(w * (user.pal > 1.5 ? 2.0 : 1.5));
            const f = Math.round(w * 0.9);
            const c = Math.round((totalKcal - (p * 4 + f * 9)) / 4);
            
            document.getElementById('p-val').innerText = p;
            document.getElementById('f-val').innerText = f;
            document.getElementById('c-val').innerText = c;

            // –ì—Ä–∞—Ñ–∏–∫
            if (user.weightHistory.v[user.weightHistory.v.length-1] !== w) {
                user.weightHistory.v.push(w);
                user.weightHistory.d.push(new Date().toLocaleDateString('ru',{day:'numeric',month:'short'}));
                updateCharts();
            }
            save();
        }
    }

    function setEnergy(type) {
        currentEnergy = type;
        document.querySelectorAll('.liquid-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('e-' + type).classList.add('active');
        renderWorkouts();
    }

    function renderWorkouts() {
        const grid = document.getElementById('w-grid');
        grid.innerHTML = '';
        workoutDatabase.forEach(w => {
            const isDimmed = (currentEnergy === 'low' && w.type === 'high') || (currentEnergy === 'high' && w.type === 'low');
            const card = document.createElement('div');
            card.className = `w-card glass-panel ${isDimmed ? 'dimmed' : ''}`;
            card.innerHTML = `
                <div class="w-name">${w.n}</div>
                <div class="w-count">${user.logs[w.id] || 0} –∑–∞–Ω—è—Ç–∏–π</div>
            `;
            card.onclick = () => { if(!isDimmed) showWModal(w); };
            grid.appendChild(card);
        });
        document.getElementById('head-total').innerText = Object.values(user.logs).reduce((a,b)=>a+b,0);
    }

    function showWModal(w) {
        activeWId = w.id;
        document.getElementById('m-title').innerText = w.n;
        document.getElementById('m-desc').innerText = w.desc;
        document.getElementById('modal').style.display = 'flex';
    }
    
    function hideWModal() { document.getElementById('modal').style.display = 'none'; }

    function logSession() {
        user.logs[activeWId] = (user.logs[activeWId] || 0) + 1;
        user.dates.push(Date.now());
        const total = Object.values(user.logs).reduce((a,b)=>a+b,0);
        
        save();
        renderWorkouts();
        hideWModal();
        tg.HapticFeedback.notificationOccurred('success');

        // –≠–ö–°–ü–ï–†–¢–ù–´–ô –°–ï–†–¢–ò–§–ò–ö–ê–¢ –ù–ê 8 –¢–†–ï–ù–ò–†–û–í–û–ö
        if (total === 8) {
            document.getElementById('cert-text').innerHTML = `
                <b>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø—Ä–æ—à–ª–∏ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø —ç–≤–æ–ª—é—Ü–∏–∏ –ú–æ–Ω–æ–ª–∏—Ç–∞.</b><br><br>
                –ó–∞ —ç—Ç–∏ 8 –∑–∞–Ω—è—Ç–∏–π –≤ –≤–∞—à–µ–º –æ—Ä–≥–∞–Ω–∏–∑–º–µ –ø—Ä–æ–∏–∑–æ—à–ª–∏ –Ω–∞—É—á–Ω–æ –¥–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:<br>
                ‚Ä¢ <b>–†–æ—Å—Ç –∫–∞–ø–∏–ª–ª—è—Ä–Ω–æ–π —Å–µ—Ç–∏:</b> –í–∞—à–∞ –∫—Ä–æ–≤–µ–Ω–æ—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–∏–ª–∞ –Ω–æ–≤—ã–µ –º–∏–∫—Ä–æ—Å–æ—Å—É–¥—ã. –î–æ—Å—Ç–∞–≤–∫–∞ –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –∫ –º—ã—à—Ü–∞–º –∏ –º–æ–∑–≥—É –≤—ã—Ä–æ—Å–ª–∞ –Ω–∞ 12-15%.<br>
                ‚Ä¢ <b>–ê–∫—Ç–∏–≤–∞—Ü–∏—è –ª–∏–º—Ñ—ã:</b> –ó–∞—Å—Ç–æ–π–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ª–∏–∫–≤–∏–¥–∏—Ä–æ–≤–∞–Ω—ã. –í—ã –∏–∑–±–∞–≤–∏–ª–∏—Å—å –æ—Ç —Å–∫—Ä—ã—Ç—ã—Ö –æ—Ç–µ–∫–æ–≤ –∏ —É—Å–∫–æ—Ä–∏–ª–∏ –≤—ã–≤–æ–¥ —Ç–æ–∫—Å–∏–Ω–æ–≤.<br>
                ‚Ä¢ <b>–ú–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</b> –í–∞—à–∏ –∫–ª–µ—Ç–∫–∏ –Ω–∞—á–∞–ª–∏ –≤—ã—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç–Ω–µ—Ä–≥–∏—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ. –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å —Ç–µ–ø–µ—Ä—å –≤—ã—à–µ, –∞ —É—Ç–æ–º–ª—è–µ–º–æ—Å—Ç—å –Ω–∏–∂–µ.<br><br>
                –≠—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ. –í–∞—à–µ —Ç–µ–ª–æ —Å—Ç–∞–ª–æ "—É–º–Ω–µ–µ" –∏ —Å–∏–ª—å–Ω–µ–µ!
            `;
            document.getElementById('cert-modal').style.display = 'flex';
        }
    }

    function updateCharts() {
        const ctxW = document.getElementById('mainChart').getContext('2d');
        if (window.wChartObj) window.wChartObj.destroy();
        window.wChartObj = new Chart(ctxW, {
            type: 'line',
            data: {
                labels: user.weightHistory.d.slice(-10),
                datasets: [{
                    data: user.weightHistory.v.slice(-10),
                    borderColor: '#fff',
                    borderWidth: 4,
                    tension: 0.4,
                    fill: { target: 'origin', above: 'rgba(255, 255, 255, 0.05)' },
                    pointBackgroundColor: '#fff',
                    pointRadius: 6
                }]
            },
            options: { 
                plugins:{legend:{display:false}}, 
                scales:{
                    x:{display:false}, 
                    y:{grid:{color:'rgba(255,255,255,0.1)'}, ticks:{color:'#888', font:{size:10}}}
                } 
            }
        });
    }

    function save() { localStorage.setItem('monolith_6_7_total', JSON.stringify(user)); }
    
    function fullReset() {
        if(confirm("–ù–∏–∫–æ–ª–∞–π, —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –æ–±–Ω—É–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞. –£–≤–µ—Ä–µ–Ω—ã?")) {
            localStorage.removeItem('monolith_6_7_total');
            location.reload();
        }
    }
</script>
</body>
</html>
