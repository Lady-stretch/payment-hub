<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lady Stretch | Biohacking App v6.2</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,700;1,700&display=swap" rel="stylesheet">
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.07);
            --glass-border: rgba(255, 255, 255, 0.15);
            --accent: #e198b1;
            --bg: #050505;
            --text: #ffffff;
            --safe: #4ade80;
            --warning: #fbbf24;
            --danger: #f87171;
            --laser: rgba(255, 255, 255, 0.9);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            background-image: radial-gradient(circle at 50% 0%, #1c1c1e, #050505);
        }

        /* --- –£–¢–û–ù–ß–ï–ù–ù–ê–Ø –≠–°–¢–ï–¢–ò–ö–ê LADY STRETCH --- */
        #splash {
            position: fixed;
            inset: 0;
            background: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .logo-wrapper {
            position: relative;
            padding: 60px; /* –ë–æ–ª—å—à–µ –≤–æ–∑–¥—É—Ö–∞ –≤–æ–∫—Ä—É–≥ –±—Ä–µ–Ω–¥–∞ */
        }

        .logo-text {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem; /* –£–º–µ–Ω—å—à–∏–ª–∏ –¥–ª—è –∏–∑—è—â–µ—Å—Ç–≤–∞ */
            font-weight: 200; /* –¢–æ–Ω—á–∞–π—à–µ–µ –Ω–∞—á–µ—Ä—Ç–∞–Ω–∏–µ */
            font-style: italic; /* –ñ–µ–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫—É—Ä—Å–∏–≤ */
            letter-spacing: 22px; /* –ü—Ä–µ–º–∏–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä—è–¥–∫–∞ */
            color: #fff;
            text-align: center;
            text-transform: uppercase;
            /* –£–±—Ä–∞–ª–∏ –≥—Ä—É–±—É—é —Ç–µ–Ω—å, –æ—Å—Ç–∞–≤–∏–ª–∏ –ª–µ–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.2));
            opacity: 0.95;
        }

        /* –¢–û–ù–ö–ò–ô –õ–ê–ó–ï–†–ù–´–ô –°–ö–ê–ù–ï–† (–ù–ò–¢–¨ –°–í–ï–¢–ê) */
        .laser-scanner {
            position: absolute;
            left: 15%; /* –õ–∞–∑–µ—Ä —Ç–µ–ø–µ—Ä—å –Ω–µ –∫–∞—Å–∞–µ—Ç—Å—è –∫—Ä–∞–µ–≤ —ç–∫—Ä–∞–Ω–∞ */
            width: 70%;
            height: 1px; /* –¢–æ–Ω–∫–∏–π –∫–∞–∫ –≤–æ–ª–æ—Å */
            /* –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –ª–∞–∑–µ—Ä –º—è–≥–∫–∏–º –ø–æ –±–æ–∫–∞–º */
            background: linear-gradient(90deg, transparent, #fff, transparent);
            box-shadow: 0 0 10px 1px var(--accent);
            z-index: 10;
            animation: laserMove 4s infinite ease-in-out;
        }

        @keyframes laserMove {
            0% { top: 0%; opacity: 0; }
            15% { opacity: 1; }
            50% { top: 100%; opacity: 1; }
            85% { opacity: 1; }
            100% { top: 0%; opacity: 0; }
        }

        @keyframes laserMove {
            0% { top: 0%; opacity: 0; }
            20% { opacity: 1; }
            50% { top: 100%; opacity: 1; }
            80% { opacity: 1; }
            100% { top: 0%; opacity: 0; }
        }

        /* --- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° --- */
        .container {
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in;
        }

        header {
            position: sticky;
            top: 10px;
            z-index: 1000;
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 18px;
            text-align: center;
            margin-bottom: 25px;
        }

        header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            letter-spacing: 4px;
            background: linear-gradient(to bottom, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 26px;
            padding: 22px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        /* –ö–Ω–æ–ø–∫–∏ –∏ –∏–Ω–ø—É—Ç—ã */
        .btn-row { display: flex; gap: 10px; margin-bottom: 12px; }
        .btn-glass {
            flex: 1;
            padding: 16px;
            border-radius: 16px;
            border: 1px solid var(--glass-border);
            background: var(--glass);
            color: #fff;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-glass.active {
            background: var(--accent);
            color: #000;
            border-color: var(--accent);
            box-shadow: 0 0 20px rgba(225, 152, 177, 0.3);
        }

        .input-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-top: 15px; }
        .input-group { text-align: center; }
        .input-group label { display: block; font-size: 0.65rem; opacity: 0.5; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1px; }
        .input-group input {
            width: 100%;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 12px;
            color: #fff;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ */
        .bio-results {
            display: flex;
            justify-content: space-around;
            margin: 25px 0 15px;
            padding-top: 20px;
            border-top: 1px solid var(--glass-border);
        }
        .bio-item { text-align: center; }
        .bio-val { display: block; font-size: 1.3rem; font-weight: 700; color: var(--accent); }
        .bio-label { font-size: 0.65rem; opacity: 0.5; margin-top: 4px; }

        .expert-verdict {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
            margin-top: 15px;
        }
        .status-line {
            width: 4px;
            height: 40px;
            background: var(--safe);
            border-radius: 10px;
            margin-right: 15px;
            transition: 0.5s;
        }
        .verdict-text { font-size: 0.85rem; line-height: 1.4; color: #ccc; }

        /* –°–µ—Ç–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ */
        .training-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 15px; }
        .train-card {
            padding: 16px;
            border-radius: 18px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            color: #fff;
            text-align: left;
            transition: 0.3s;
        }
        .train-card:active { transform: scale(0.97); background: rgba(255,255,255,0.1); }
        .train-card b { display: block; font-size: 0.9rem; color: var(--accent); margin-bottom: 5px; }
        .train-card span { font-size: 0.65rem; opacity: 0.5; }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            padding: 20px;
        }
        .modal-body {
            background: linear-gradient(135deg, #1a1a1c, #050505);
            border: 1px solid var(--glass-border);
            padding: 30px;
            border-radius: 30px;
            width: 100%;
            max-width: 400px;
            position: relative;
            text-align: center;
        }
        .modal-body h2 { font-family: 'Playfair Display', serif; margin-bottom: 15px; color: var(--accent); }

        /* –ì—Ä–∞—Ñ–∏–∫–∏ */
        .chart-container { height: 120px; width: 100%; margin-top: 15px; position: relative; }
        .chart-svg { width: 100%; height: 100%; overflow: visible; }
        
        /* –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ */
        .danger-zone { margin-top: 30px; text-align: center; }
        .btn-reset { background: none; border: none; color: #444; font-size: 0.75rem; text-decoration: underline; cursor: pointer; }

    </style>
</head>
<body>

    <div id="splash">
        <div class="logo-wrapper">
            <div class="laser-scanner"></div>
            <div class="logo-text">Lady Stretch</div>
        </div>
        <p style="letter-spacing: 5px; font-size: 0.7rem; opacity: 0.5; margin-top: 20px; color: #fff;">BIOHACKING SYSTEM v6.2</p>
    </div>

    <div class="container" id="app">
        <header>
            <h1>LADY STRETCH</h1>
        </header>

        <div class="glass-card">
            <div class="btn-row">
                <button class="btn-glass active" id="btn-female" onclick="updateGender('female')">–ñ–ï–ù–©–ò–ù–ê</button>
                <button class="btn-glass" id="btn-male" onclick="updateGender('male')">–ú–£–ñ–ß–ò–ù–ê</button>
            </div>
            <button class="btn-glass" style="width: 100%; margin-bottom: 15px;" onclick="toggleModal('activityModal', true)">
                –ê–ö–¢–ò–í–ù–û–°–¢–¨: <span id="display-activity">–°—Ä–µ–¥–Ω—è—è</span>
            </button>

            <div class="input-row">
                <div class="input-group">
                    <label>–í–µ—Å (–∫–≥)</label>
                    <input type="number" id="in-weight" value="60" oninput="runBiohacking()">
                </div>
                <div class="input-group">
                    <label>–†–æ—Å—Ç (—Å–º)</label>
                    <input type="number" id="in-height" value="170" oninput="runBiohacking()">
                </div>
                <div class="input-group">
                    <label>–í–æ–∑—Ä–∞—Å—Ç</label>
                    <input type="number" id="in-age" value="28" oninput="runBiohacking()">
                </div>
            </div>

            <div class="bio-results">
                <div class="bio-item">
                    <span class="bio-val" id="res-bmi">20.8</span>
                    <span class="bio-label">–ò–ú–¢</span>
                </div>
                <div class="bio-item">
                    <span class="bio-val" id="res-water">2.1–ª</span>
                    <span class="bio-label">–í–û–î–ê</span>
                </div>
                <div class="bio-item">
                    <span class="bio-val" id="res-kcal">1850</span>
                    <span class="bio-label">–ö–ö–ê–õ</span>
                </div>
            </div>

            <div class="expert-verdict">
                <div class="status-line" id="status-color"></div>
                <div class="verdict-text" id="expert-text">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–æ–º–µ—Ç—Ä–∏–∏...</div>
            </div>

            <div style="margin-top: 15px; display: flex; justify-content: space-between; font-size: 0.7rem; opacity: 0.6; padding: 0 10px;">
                <span>–ë–µ–ª–∫–∏: <b id="res-p" style="color:var(--accent)">--</b></span>
                <span>–ñ–∏—Ä—ã: <b id="res-f" style="color:var(--accent)">--</b></span>
                <span>–£–≥–ª–µ–≤–æ–¥—ã: <b id="res-c" style="color:var(--accent)">--</b></span>
            </div>
        </div>

        <div class="glass-card">
            <h3 style="font-size: 0.8rem; margin-bottom: 15px; opacity: 0.7; letter-spacing: 1px;">–í–ê–® –¢–ï–ö–£–©–ò–ô –†–ï–°–£–†–°</h3>
            <div class="btn-row">
                <button class="btn-glass" id="res-low" onclick="updateResource('low')">–°–ü–ê–î</button>
                <button class="btn-glass active" id="res-norm" onclick="updateResource('norm')">–ù–û–†–ú–ê</button>
                <button class="btn-glass" id="res-peak" onclick="updateResource('peak')">–ü–ò–ö</button>
            </div>

            <div class="training-grid" id="training-list">
                </div>
        </div>

        <div class="glass-card">
            <h3 style="font-size: 0.8rem; margin-bottom: 10px; opacity: 0.7;">–í–ê–® –£–†–û–í–ï–ù–¨: <span id="user-level-name" style="color:var(--accent)">–ù–æ–≤–∏—á–æ–∫</span></h3>
            <p id="session-count" style="font-size: 0.7rem; opacity: 0.5;">–ü—Ä–æ–π–¥–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π: 0</p>
            
            <div style="margin-top: 20px;">
                <p style="font-size: 0.75rem; opacity: 0.8;">–î–∏–Ω–∞–º–∏–∫–∞ –≤–µ—Å–∞</p>
                <div class="chart-container">
                    <svg class="chart-svg" viewBox="0 0 100 40">
                        <path d="M0 35 Q 25 32, 50 25 T 100 15" fill="none" stroke="var(--accent)" stroke-width="1.5" />
                        <circle cx="100" cy="15" r="2" fill="var(--accent)" />
                    </svg>
                </div>
            </div>

            <div style="margin-top: 10px;">
                <p style="font-size: 0.75rem; opacity: 0.8;">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</p>
                <div class="chart-container" style="display:flex; align-items:flex-end; gap:8px; padding-bottom:5px;">
                    <div style="flex:1; height:30%; background:var(--glass-border); border-radius:4px;"></div>
                    <div style="flex:1; height:60%; background:var(--accent); border-radius:4px;"></div>
                    <div style="flex:1; height:45%; background:var(--glass-border); border-radius:4px;"></div>
                    <div style="flex:1; height:90%; background:var(--accent); border-radius:4px;"></div>
                    <div style="flex:1; height:20%; background:var(--glass-border); border-radius:4px;"></div>
                </div>
            </div>

            <button class="btn-glass active" style="width: 100%; margin-top: 25px;" onclick="window.open('https://ladystretch.ru', '_blank')">–û–ë–ù–û–í–ò–¢–¨ –ê–ë–û–ù–ï–ú–ï–ù–¢</button>
            
            <div class="danger-zone">
                <button class="btn-reset" onclick="resetAllData()">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–∞–Ω–Ω—ã–µ</button>
            </div>
        </div>
    </div>

    <div id="activityModal" class="modal-overlay" onclick="toggleModal('activityModal', false)">
        <div class="modal-body" onclick="event.stopPropagation()">
            <h2>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>
            <button class="btn-glass" style="width:100%; margin-bottom:10px;" onclick="setActivity(1.2, '–ù–∏–∑–∫–∞—è')">–ù–∏–∑–∫–∞—è (–°–∏–¥—è—á–∞—è)</button>
            <button class="btn-glass active" style="width:100%; margin-bottom:10px;" onclick="setActivity(1.5, '–°—Ä–µ–¥–Ω—è—è')">–°—Ä–µ–¥–Ω—è—è (–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏)</button>
            <button class="btn-glass" style="width:100%; margin-bottom:10px;" onclick="setActivity(1.9, '–í—ã—Å–æ–∫–∞—è')">–í—ã—Å–æ–∫–∞—è (–ü—Ä–æ—Ñ–∏)</button>
        </div>
    </div>

    <div id="trainModal" class="modal-overlay" onclick="toggleModal('trainModal', false)">
        <div class="modal-body" onclick="event.stopPropagation()">
            <h2 id="m-train-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h2>
            <p id="m-train-desc" style="font-size: 0.9rem; color: #ccc; line-height: 1.5; margin-bottom: 20px;"></p>
            <div style="background: rgba(225,152,177,0.1); border-left: 3px solid var(--accent); padding: 15px; text-align: left;">
                <b style="font-size: 0.75rem; color: var(--accent); display: block; margin-bottom: 5px;">–≠–ö–°–ü–ï–†–¢–ù–û–ï –ú–ù–ï–ù–ò–ï:</b>
                <p id="m-train-expert" style="font-size: 0.85rem; font-style: italic;"></p>
            </div>
            <button class="btn-glass active" style="width:100%; margin-top:20px;" onclick="logTraining()">–Ø –ë–´–õ–ê –ù–ê –¢–†–ï–ù–ò–†–û–í–ö–ï</button>
        </div>
    </div>

    <div id="levelModal" class="modal-overlay" onclick="toggleModal('levelModal', false)">
        <div class="modal-body">
            <div style="font-size: 4rem; margin-bottom: 15px;">üèÜ</div>
            <h2 id="m-level-name">–£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω!</h2>
            <p id="m-level-desc" style="font-size: 0.95rem; line-height: 1.5; margin-bottom: 20px;"></p>
            <button class="btn-glass active" style="width:100%;" onclick="toggleModal('levelModal', false)">–ü–†–ò–ù–Ø–¢–¨</button>
        </div>
    </div>

    <script>
        // –î–ê–ù–ù–´–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        let state = {
            gender: 'female',
            activity: 1.5,
            actName: '–°—Ä–µ–¥–Ω—è—è',
            resource: 'norm',
            sessions: 0,
            level: 0,
            lastWeight: 60
        };

        const levels = [
            { count: 0, name: '–ù–æ–≤–∏—á–æ–∫', desc: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä Lady Stretch! –í–∞—à–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–µ–≥–æ–¥–Ω—è.' },
            { count: 8, name: '–ê–¥–µ–ø—Ç', desc: '8 –∑–∞–Ω—è—Ç–∏–π –ø–æ–∑–∞–¥–∏! –ú—ã—à–µ—á–Ω–∞—è —ç–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å –≤—ã—Ä–æ—Å–ª–∞ –Ω–∞ 15%, —É–ª—É—á—à–∏–ª–æ—Å—å –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏–µ –∏ –ª–∏–º—Ñ–æ–¥—Ä–µ–Ω–∞–∂.' },
            { count: 30, name: '–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è', desc: '30 –∑–∞–Ω—è—Ç–∏–π! –í–∞—à–∞ –æ—Å–∞–Ω–∫–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∞—Å—å, —É—Ä–æ–≤–µ–Ω—å –∫–æ—Ä—Ç–∏–∑–æ–ª–∞ —Å–Ω–∏–∂–µ–Ω. –¢–µ–ª–æ –º–µ–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É.' },
            { count: 50, name: '–ú–∞—Å—Ç–µ—Ä', desc: '50 –∑–∞–Ω—è—Ç–∏–π! –ú–µ—Ç–∞–±–æ–ª–∏–∑–º —É—Å–∫–æ—Ä–∏–ª—Å—è, –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –Ω–∞ –ø–∏–∫–µ. –í—ã –≤—ã–≥–ª—è–¥–∏—Ç–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–µ.' },
            { count: 100, name: '–≠–∫—Å–ø–µ—Ä—Ç', desc: '100 –∑–∞–Ω—è—Ç–∏–π! –ù–æ–≤–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏. –ì–ª—É–±–æ–∫–∏–π –º—ã—à–µ—á–Ω—ã–π –∫–æ—Ä—Å–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω.' },
            { count: 150, name: '–õ–µ–≥–µ–Ω–¥–∞', desc: '150 –∑–∞–Ω—è—Ç–∏–π! –í—ã ‚Äî –∏–∫–æ–Ω–∞ Lady Stretch. –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ç–µ–ª–æ–º –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.' }
        ];

        const trainingLib = {
            "–ü–∏–ª–∞—Ç–µ—Å": { d: "–ü—Ä–æ—Ä–∞–±–æ—Ç–∫–∞ –≥–ª—É–±–æ–∫–æ–≥–æ –∫–æ—Ä—Å–µ—Ç–∞ –∏ –≤—ã—Ç—è–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞.", e: "–ß–µ—Ä–µ–∑ 2 –º–µ—Å—è—Ü–∞ –±–æ–ª–∏ –≤ —Å–ø–∏–Ω–µ —É–π–¥—É—Ç, –∂–∏–≤–æ—Ç —Å—Ç–∞–Ω–µ—Ç –ø–æ–¥—Ç—è–Ω—É—Ç—ã–º." },
            "–°—Ç—Ä–µ—Ç—á–∏–Ω–≥": { d: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –≥–∏–±–∫–æ—Å—Ç—å—é –∏ —Å–Ω—è—Ç–∏–µ –∑–∞–∂–∏–º–æ–≤.", e: "–ú—ã—à—Ü—ã –ø—Ä–∏–æ–±—Ä–µ—Ç—É—Ç –∫—Ä–∞—Å–∏–≤—ã–π —É–¥–ª–∏–Ω–µ–Ω–Ω—ã–π —Ä–µ–ª—å–µ—Ñ –∏ –ª–µ–≥–∫–æ—Å—Ç—å." },
            "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞": { d: "–ì–ª—É–±–æ–∫–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ —à–ø–∞–≥–∞—Ç–∞–º–∏ –∏ —Å–ø–∏–Ω–æ–π.", e: "–£–±–∏—Ä–∞–µ—Ç –ø—Å–∏—Ö–æ—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–∏ –∏ –¥–µ–ª–∞–µ—Ç —Å—É—Å—Ç–∞–≤—ã –º–æ–ª–æ–¥—ã–º–∏." },
            "–ú–§–†": { d: "–°–∞–º–æ–º–∞—Å—Å–∞–∂ —Ä–æ–ª–ª–∞–º–∏ –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è —Ñ–∞—Å—Ü–∏–π.", e: "–£—Å–∫–æ—Ä—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ 2 —Ä–∞–∑–∞ –∏ —É–±–∏—Ä–∞–µ—Ç –æ—Ç–µ–∫–∏." },
            "–°–∫–∞–π —Å—Ç—Ä–µ—Ç—á–∏–Ω–≥": { d: "–†–∞—Å—Ç—è–∂–∫–∞ –≤ –≥–∞–º–∞–∫–∞—Ö –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –Ω–µ–≤–µ—Å–æ–º–æ—Å—Ç–∏.", e: "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏—è –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞ –∏ —á—É–≤—Å—Ç–≤–æ –ø–æ–ª–µ—Ç–∞." },
            "–ô–æ–≥–∞ —Ä–µ–ª–∞–∫—Å": { d: "–ú—è–≥–∫–∏–µ –∞—Å–∞–Ω—ã –∏ –¥—ã—Ö–∞–Ω–∏–µ –¥–ª—è —Å–Ω—è—Ç–∏—è —Å—Ç—Ä–µ—Å—Å–∞.", e: "–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –∑–¥–æ—Ä–æ–≤—ã–π —Å–æ–Ω." },
            "–ó–¥–æ—Ä–æ–≤–∞—è —Å–ø–∏–Ω–∞": { d: "–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –º—ã—à–µ—á–Ω–æ–≥–æ –∫–æ—Ä—Å–µ—Ç–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –æ—Å–∞–Ω–∫–∏.", e: "–§—É–Ω–¥–∞–º–µ–Ω—Ç –∑–¥–æ—Ä–æ–≤—å—è. –í—ã —Ä–∞—Å–ø—Ä–∞–≤–∏—Ç–µ –ø–ª–µ—á–∏ –∏ –∑–∞–±—É–¥–µ—Ç–µ –æ —Å—É—Ç—É–ª–æ—Å—Ç–∏." },
            "–ü–æ–¥–∫–∞—á–∫–∞ —Å —Ä–∞—Å—Ç—è–∂–∫–æ–π": { d: "–°–∏–ª–æ–≤–æ–π –±–ª–æ–∫ + –≥–∏–±–∫–æ—Å—Ç—å –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ —Ç–æ–Ω—É—Å–∞.", e: "–¢–µ–ª–æ —Å—Ç–∞–Ω–µ—Ç —É–ø—Ä—É–≥–∏–º, —É–π–¥–µ—Ç –¥—Ä—è–±–ª–æ—Å—Ç—å, –∫–æ–∂–∞ –ø–æ–¥—Ç—è–Ω–µ—Ç—Å—è." },
            "–ö—Ä—É–≥–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞": { d: "–ò–Ω—Ç–µ–Ω—Å–∏–≤ –Ω–∞ –≤—Å–µ –≥—Ä—É–ø–ø—ã –º—ã—à—Ü –¥–ª—è –∂–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏—è.", e: "–†–∞–∑–≥–æ–Ω –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞. –ñ–∏—Ä —Å–≥–æ—Ä–∞–µ—Ç –µ—â–µ 48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏." },
            "–ë–æ–¥–∏—Å–∫—É–ª—å–ø—Ç": { d: "–°–∫—É–ª—å–ø—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π —Ç–µ–ª–∞.", e: "–ü—Ä–æ—Ä–∏—Å–æ–≤–∫–∞ —Ä–µ–ª—å–µ—Ñ–∞. –ö–∞–∂–¥–∞—è –º—ã—à—Ü–∞ —Å—Ç–∞–Ω–µ—Ç —Ç–æ—á–µ–Ω–æ–π." },
            "–Ø–≥–æ–¥–∏—Ü—ã + –ü—Ä–µ—Å—Å": { d: "–ê–∫—Ü–µ–Ω—Ç –Ω–∞ —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –∑–æ–Ω—ã.", e: "–ú–æ—â–Ω—ã–π –ª–∏–º—Ñ–æ–¥—Ä–µ–Ω–∞–∂ –Ω–∏–∑–∞ –∏ –ø–ª–æ—Å–∫–∏–π, –∂–µ–ª–µ–∑–Ω—ã–π –∂–∏–≤–æ—Ç." },
            "–¢–∞–±–∞—Ç–∞": { d: "–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–∏–Ω–≥ –¥–ª—è –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏.", e: "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞—Å—Ö–æ–¥ –∫–∞–ª–æ—Ä–∏–π –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è." },
            "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª": { d: "–†–∞–∑–≤–∏—Ç–∏–µ —Å–∏–ª—ã –∏ –ª–æ–≤–∫–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è.", e: "–í—ã —Å—Ç–∞–Ω–µ—Ç–µ —ç–Ω–µ—Ä–≥–∏—á–Ω–µ–µ, —É–π–¥–µ—Ç –±—ã—Ç–æ–≤–∞—è —É—Å—Ç–∞–ª–æ—Å—Ç—å." }
        };

        const resourceMap = {
            low: ["–ü–∏–ª–∞—Ç–µ—Å", "–°—Ç—Ä–µ—Ç—á–∏–Ω–≥", "–ú–§–†", "–ô–æ–≥–∞ —Ä–µ–ª–∞–∫—Å", "–ó–¥–æ—Ä–æ–≤–∞—è —Å–ø–∏–Ω–∞"],
            norm: ["–ü–∏–ª–∞—Ç–µ—Å", "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞", "–°–∫–∞–π —Å—Ç—Ä–µ—Ç—á–∏–Ω–≥", "–ü–æ–¥–∫–∞—á–∫–∞ —Å —Ä–∞—Å—Ç—è–∂–∫–æ–π", "–ë–æ–¥–∏—Å–∫—É–ª—å–ø—Ç"],
            peak: ["–ö—Ä—É–≥–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞", "–Ø–≥–æ–¥–∏—Ü—ã + –ü—Ä–µ—Å—Å", "–¢–∞–±–∞—Ç–∞", "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª", "–ë–æ–¥–∏—Å–∫—É–ª—å–ø—Ç"]
        };

        // –õ–û–ì–ò–ö–ê
        window.onload = () => {
            loadData();
            setTimeout(() => {
                const splash = document.getElementById('splash');
                splash.style.opacity = '0';
                setTimeout(() => {
                    splash.style.display = 'none';
                    const app = document.getElementById('app');
                    app.style.display = 'block';
                    setTimeout(() => app.style.opacity = '1', 50);
                    runBiohacking();
                    renderTrainings();
                }, 1500);
            }, 3500);
        };

        function runBiohacking() {
            const w = parseFloat(document.getElementById('in-weight').value) || 0;
            const h = parseFloat(document.getElementById('in-height').value) || 0;
            const a = parseFloat(document.getElementById('in-age').value) || 0;

            // 1. –†–∞—Å—á–µ—Ç –ò–ú–¢
            const bmi = (w / ((h/100)**2)).toFixed(1);
            document.getElementById('res-bmi').innerText = bmi;

            // 2. –†–∞—Å—á–µ—Ç –í–æ–¥—ã
            const water = (w * 0.035).toFixed(1);
            document.getElementById('res-water').innerText = water + '–ª';

            // 3. –†–∞—Å—á–µ—Ç –ö–∞–ª–æ—Ä–∏–π (–ú–∏—Ñ—Ñ–ª–∏–Ω-–°–∞–Ω –ñ–µ–æ—Ä)
            let bmr = (10 * w) + (6.25 * h) - (5 * a);
            bmr = state.gender === 'female' ? bmr - 161 : bmr + 5;
            const kcal = Math.round(bmr * state.activity);
            document.getElementById('res-kcal').innerText = kcal;

            // 4. –†–∞—Å—á–µ—Ç –ë–ñ–£
            document.getElementById('res-p').innerText = Math.round(w * 1.6) + '–≥';
            document.getElementById('res-f').innerText = Math.round(w * 0.9) + '–≥';
            document.getElementById('res-c').innerText = Math.round((kcal - (w*1.6*4) - (w*0.9*9)) / 4) + '–≥';

            // 5. –≠–ö–°–ü–ï–†–¢–ù–û–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï (–£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ Lady Stretch)
            const text = document.getElementById('expert-text');
            const line = document.getElementById('status-color');

            // –°—Ü–µ–Ω–∞—Ä–∏–π –ê: –í–æ–∑—Ä–∞—Å—Ç 40+ –∏ –ª–∏—à–Ω–∏–π –≤–µ—Å –ø—Ä–∏ –Ω–∏–∑–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–¢–≤–æ–π —Å–ª—É—á–∞–π)
            if (a >= 40 && bmi > 26 && state.activity <= 1.25) {
                text.innerHTML = `<span style="color:var(--accent); font-weight:bold;">–≠–ö–°–ü–ï–†–¢–ù–´–ô –ü–õ–ê–ù:</span> –í –≤–∞—à–µ–º –≤–æ–∑—Ä–∞—Å—Ç–µ –ø—Ä–∏ –ò–ú–¢ ${bmi} –≤–∞–∂–Ω–æ –±–µ—Ä–µ—á—å —Å—É—Å—Ç–∞–≤—ã. –ù–∞—á–∏–Ω–∞–µ–º —Å <b>–ú–§–†</b> –∏ <b>–ó–¥–æ—Ä–æ–≤–æ–π —Å–ø–∏–Ω—ã</b>. –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∫–∞ –∏—Å–∫–ª—é—á–∞–µ–º.`;
                line.style.background = 'var(--warning)';
                line.style.boxShadow = '0 0 15px var(--warning)';
            } 
            // –°—Ü–µ–Ω–∞—Ä–∏–π –ë: –î–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã
            else if (bmi < 18.5) {
                text.innerText = "–î–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ü–æ–¥–∫–∞—á–∫—É –∏ –ø—Ä–æ—Ñ–∏—Ü–∏—Ç –∫–∞–ª–æ—Ä–∏–π –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º—ã—à–µ—á–Ω–æ–≥–æ –∫–æ—Ä—Å–µ—Ç–∞.";
                line.style.background = 'var(--warning)';
            } 
            // –°—Ü–µ–Ω–∞—Ä–∏–π –í: –û–∂–∏—Ä–µ–Ω–∏–µ –∏–ª–∏ –≤—ã—Å–æ–∫–∏–π –ò–ú–¢ —É –º–æ–ª–æ–¥—ã—Ö/–∞–∫—Ç–∏–≤–Ω—ã—Ö
            else if (bmi > 25) {
                text.innerText = "–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ò–ú–¢. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∂–∏—Ä–æ—Å–∂–∏–≥–∞—é—â–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª: –ö—Ä—É–≥–æ–≤—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –¢–∞–±–∞—Ç–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏–π.";
                line.style.background = 'var(--danger)';
            } 
            // –°—Ü–µ–Ω–∞—Ä–∏–π –ì: –ù–æ—Ä–º–∞
            else {
                text.innerText = "–í–∞—à–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≤ –∏–¥–µ–∞–ª—å–Ω–æ–π –Ω–æ—Ä–º–µ. –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –±–∏–æ–±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ —Ä–∞—Å—Ç—è–∂–∫—É –∏ –ø–∏–ª–∞—Ç–µ—Å.";
                line.style.background = 'var(--safe)';
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –ø–æ–¥ –Ω–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è
            renderTrainings(); 
            saveData();
        }

        function renderTrainings() {
            const list = document.getElementById('training-list');
            list.innerHTML = '';
            const items = resourceMap[state.resource];
            items.forEach(name => {
                const card = document.createElement('div');
                card.className = 'train-card';
                card.innerHTML = `<b>${name}</b><span>–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ø–æ–ª—å–∑–µ...</span>`;
                card.onclick = () => openTrainDetails(name);
                list.appendChild(card);
            });
        }

        let selectedTraining = "";
        function openTrainDetails(name) {
            selectedTraining = name;
            const data = trainingLib[name];
            document.getElementById('m-train-title').innerText = name;
            document.getElementById('m-train-desc').innerText = data.d;
            document.getElementById('m-train-expert').innerText = data.e;
            toggleModal('trainModal', true);
        }

        function logTraining() {
            state.sessions++;
            toggleModal('trainModal', false);
            updateLevelDisplay();
            checkLevelUp();
            saveData();
        }

        function checkLevelUp() {
            const currentLevel = levels.filter(l => state.sessions >= l.count).pop();
            const levelIdx = levels.indexOf(currentLevel);
            if(levelIdx > state.level) {
                state.level = levelIdx;
                document.getElementById('m-level-name').innerText = currentLevel.name;
                document.getElementById('m-level-desc').innerText = currentLevel.desc;
                toggleModal('levelModal', true);
            }
        }

        function updateLevelDisplay() {
            const currentLevel = levels[state.level] || levels[0];
            document.getElementById('user-level-name').innerText = currentLevel.name;
            document.getElementById('session-count').innerText = `–ü—Ä–æ–π–¥–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π: ${state.sessions}`;
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function updateGender(g) {
            state.gender = g;
            document.getElementById('btn-female').classList.toggle('active', g === 'female');
            document.getElementById('btn-male').classList.toggle('active', g === 'male');
            runBiohacking();
        }

        function updateResource(r) {
            state.resource = r;
            ['low', 'norm', 'peak'].forEach(key => {
                document.getElementById('res-' + key).classList.toggle('active', r === key);
            });
            renderTrainings();
            saveData();
        }

        function setActivity(val, name) {
            state.activity = val;
            state.actName = name;
            document.getElementById('display-activity').innerText = name;
            toggleModal('activityModal', false);
            runBiohacking();
        }

        function toggleModal(id, show) {
            document.getElementById(id).style.display = show ? 'flex' : 'none';
        }

        function saveData() {
            state.lastWeight = document.getElementById('in-weight').value;
            localStorage.setItem('ls_bio_state', JSON.stringify(state));
        }

        function loadData() {
            const saved = localStorage.getItem('ls_bio_state');
            if(saved) {
                state = JSON.parse(saved);
                document.getElementById('in-weight').value = state.lastWeight || 60;
                document.getElementById('display-activity').innerText = state.actName;
                updateLevelDisplay();
            }
        }

        function resetAllData() {
            if(confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω—É–ª–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')) {
                localStorage.removeItem('ls_bio_state');
                location.reload();
            }
        }
    </script>
</body>
</html>
